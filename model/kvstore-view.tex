\begin{definition}[Multi-version Key-value Stores]
\label{def:mkvs-appendix}
Assume a countably infinite set of \emph{keys} $\Keys \ni \ke$, 
and a countably infinite set of  \emph{values} $\Val \ni \val$, 
including an \emph{initialisation value} $\val_0 $.
The set of \emph{versions}, $\Versions \ni \ver$, is: $\Versions \defeq \Val \times \TxID \times \powerset{\TxID_{0}}$. 
A \emph{key-value store}, abbreviated to kv-store,  is a function $\hh: \Keys \rightarrow \Versions^{\ast}$, 
where $\Versions^{\ast}$ is the free monoid on $\Versions$. 
The \emph{initial key-value store} is given by $\hh_0$, where 
$\hh_{0}(\ke)\defeq  (\val_0, \txid_0, \emptyset)$ for
all $\ke \in \Keys$.
Well-formed key-values store satisfy:
\begin{align}
& \fora{\ke, i, j} 
\RTx(\hh(\ke, i)) \cap \RTx(\hh(\ke, j)) \neq \emptyset \lor
\WTx(\hh(\ke, i)) = \WTx(\hh(\ke, j))
\implies i = j  \\
& \fora{\ke} \hh(\ke, 0) = (\val_0, \txid_0, \stub) \\
& \fora{ \ke, \cl, i,j, n, m} 
\txid_{\cl}^{n} = \WTx(\hh(\ke,i)) \wedge \txid_{\cl}^{m} \in
\Set{\WTx(\hh(\ke,j))} \cup \RTx(\hh(\ke, i)) \implies n < m
\end{align}
\end{definition}

Given the \cref{def:snapshot}, 
a kv-store $\hh$, a key $\ke$ and a view $\vi$, 
we write $\hh(\ke, \vi)$ as a shorthand for 
$\hh(\ke, \max_{<}(\vi(\ke))$. Thus, $\snapshot(\hh, \vi) = \lambda \ke \ldotp \valueOf(\hh(\ke, \vi))$. 
