\begin{definition}[Multi-version Key-value Stores]
\label{def:mkvs-appendix}
Assume a countably infinite set of \emph{keys} $\Keys \ni \key$, 
and a countably infinite set of  \emph{values} $\Val \ni \val$, 
including an \emph{initialisation value} $\val_0 $.
The set of \emph{versions}, $\Versions \ni \ver$, is: $\Versions \defeq \Val \times \TxID \times \pset{\TxID_{0}}$. 
A \emph{key-value store}, abbreviated to kv-store,  is a function $\mkvs: \Keys \rightarrow \Versions^{\ast}$, 
where $\Versions^{\ast}$ is the free monoid on $\Versions$. 
The \emph{initial key-value store} is given by $\mkvs_0$, where 
$\mkvs_{0}(\key)\defeq  (\val_0, \txid_0, \emptyset)$ for
all $\key \in \Keys$.
Well-formed key-values store satisfy:
\begin{align}
& \fora{\key, i, j} 
\RTx(\mkvs(\key, i)) \cap \RTx(\mkvs(\key, j)) \neq \emptyset \lor
\WTx(\mkvs(\key, i)) = \WTx(\mkvs(\key, j))
\implies i = j  \\
& \fora{\key} \mkvs(\key, 0) = (\val_0, \txid_0, \stub) \\
& \fora{ \key, \cl, i,j, n, m} 
\txid_{\cl}^{n} = \WTx(\mkvs(\key,i)) \wedge \txid_{\cl}^{m} \in
\Set{\WTx(\mkvs(\key,j))} \cup \RTx(\mkvs(\key, i)) \implies n < m
\end{align}
\end{definition}

Given the \cref{def:snapshot}, 
a kv-store $\mkvs$, a key $\key$ and a view $\vi$, 
we write $\mkvs(\key, \vi)$ as a shorthand for 
$\mkvs(\key, \max_{<}(\vi(\key))$. Thus, $\snapshot(\mkvs, \vi) = \lambda \key \ldotp \valueOf(\mkvs(\key, \vi))$. 
