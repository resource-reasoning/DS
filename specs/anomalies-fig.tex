\begin{figure*}[t]
\captionsetup[subfigure]{aboveskip=-5pt, belowskip=5pt}
\begin{tabular}{@{} c | c | c @{}}
\hline
\phantom{-}& \phantom{-}& \phantom{-}\\
\begin{subfigure}{0.2\textwidth}
\begin{centertikz}
%Location x
\node(locx) {$\ke_1 \mapsto$};

\matrix(versionx) [version list, column 2/.style={text width=8mm}, column 4/.style={text width=8mm}]
    at ([xshift=\tikzkvspace]locx.east) {
    {a} \& $\txid_0$ \& {a} \& $\txid_1$\\
    {a} \& $\left\{\txid_{\cl}^{2}\right\}$ \& {a} \& $\left\{\txid_{\cl}^{1} \right\}$ \\
};
\tikzvalue{versionx-1-1}{versionx-2-1}{locx-v0}{$v_0$};
\tikzvalue{versionx-1-3}{versionx-2-3}{locx-v1}{$v_1$};
\end{centertikz}\vspace{5pt}%
\caption{Disallowed by \(\MRd\)}
\label{fig:mr-disallowed}
\end{subfigure}
%\quad
&
\begin{subfigure}{0.36\textwidth}
\begin{centertikz}

%Location x
\node(locx) {$\ke_1 \mapsto$};

\matrix(versionx) [version list, column 2/.style={text width=8mm}, column 4/.style={text width=8mm}]
    at ([xshift=\tikzkvspace]locx.east) {
    {a} \& $\txid_0$ \& {a} \& $\txid_{\cl}^{1}$\\
    {a} \& $\left\{\txid' \right\}$ \& {a} \& $\emptyset$ \\
};
\tikzvalue{versionx-1-1}{versionx-2-1}{locx-v0}{$v_0$};
\tikzvalue{versionx-1-3}{versionx-2-3}{locx-v1}{$v_1$};

%Location y
\path (versionx.east) + (1,0) node (locy) {$\ke_2 \mapsto$};
\matrix(versiony) [version list, column 2/.style={text width=8mm}, column 4/.style={text width=8mm}]
   at ([xshift=\tikzkvspace]locy.east) {
 {a} \& $\txid_0$ \& {a} \& $\txid_{\cl}^2$ \\
  {a} \& $\emptyset$ \& {a} \& $\{\txid'\}$\\
};

\tikzvalue{versiony-1-1}{versiony-2-1}{locy-v0}{$v_0$};
\tikzvalue{versiony-1-3}{versiony-2-3}{locy-v1}{$v_2$};
\end{centertikz}\vspace{5pt}
\caption{Disallowed by \(\MW\)}
\label{fig:mw-disallowed}
\end{subfigure}
%\quad
&
\begin{subfigure}{0.39\textwidth}
\begin{centertikz}

%Location x
\node(locx) {$\ke_1 \mapsto$};

\matrix(versionx) [version list,column 2/.style={text width=8mm}, column 4/.style={text width=8mm}]
    at ([xshift=\tikzkvspace]locx.east) {
    {a} \& $\txid_0$ \& {a} \& $\txid'$\\
    {a} \& $\{\txid\}$ \& {a} \& $\left\{ \txid_{\cl}^1 \right\}$ \\
};
\tikzvalue{versionx-1-1}{versionx-2-1}{locx-v0}{$\val_0$};
\tikzvalue{versionx-1-3}{versionx-2-3}{locx-v1}{$\val_1$};

%Location y
\path (versionx.east) + (1,0) node (locy) {$\ke_2 \mapsto$};
\matrix(versiony) [version list,column 2/.style={text width=8mm}, column 4/.style={text width=8mm}]
   at ([xshift=\tikzkvspace]locy.east) {
 {a} \& $\txid_0$ \& {a} \& $\txid_{\cl}^2$ \\
  {a} \& $\emptyset$ \& {a} \& $\{\txid\}$\\
};

\tikzvalue{versiony-1-1}{versiony-2-1}{locy-v0}{$v_0$};
\tikzvalue{versiony-1-3}{versiony-2-3}{locy-v1}{$v_2$};
\end{centertikz}

\vspace{5pt}
\caption{Disallowed by \(\WFR\)}
\label{fig:wfr-disallowed}
\end{subfigure}\\
\hline
\end{tabular}
%
%
%
%
\begin{tabular}{@{} c | c | c @{}}
\phantom{-}& \phantom{-}& \phantom{-}\\
\begin{subfigure}{0.25\textwidth}
\begin{centertikz}%
%Location x
\node(locx) {$\ke_1 \mapsto$};

\matrix(versionx) [version list, column 2/.style={text width=14mm}]
    at ([xshift=\tikzkvspace]locx.east) {
    {a} \& $\txid_0$ \& {a} \& $\txid_{\cl}^{1}$ \& {a} \& $\txid_{\cl}^{2}$\\
    {a} \& $\left\{\txid_{\cl}^{1}, \txid_{\cl}^{2}\right\}$ \& {a} \& $\emptyset$ \& {a} \& $\emptyset$ \\
};
\tikzvalue{versionx-1-1}{versionx-2-1}{locx-v0}{$0$};
\tikzvalue{versionx-1-3}{versionx-2-3}{locx-v1}{$1$};
\tikzvalue{versionx-1-5}{versionx-2-5}{locx-v2}{$1$};
\end{centertikz}%
\vspace{5pt}
\caption{Disallowed by \(\RYW\)}
\label{fig:ryw-disallowed}
\end{subfigure}
& 

\begin{subfigure}{0.40\textwidth}
\begin{centertikz}%
%Location x
\node(locx) {$\ke_1 \mapsto$};

\matrix(versionx) [version list,column 2/.style={text width=8mm},column 4/.style={text width=8mm}]
    at ([xshift=\tikzkvspace]locx.east) {
    {a} \& $\txid_0$ \& {a} \& $\txid_1$\\
    {a} \& $\left\{\txid_2\right\}$ \& {a} \& $\emptyset$ \\
};
\tikzvalue{versionx-1-1}{versionx-2-1}{locx-v0}{$\val_0$};
\tikzvalue{versionx-1-3}{versionx-2-3}{locx-v1}{$\val_1$};

%Location y
\path (versionx.east) + (1,0) node (locy) {$\ke_2 \mapsto$};
\matrix(versiony) [version list,column 2/.style={text width=8mm},column 4/.style={text width=8mm}]
   at ([xshift=\tikzkvspace]locy.east) {
 {a}  \& $\txid_0$ \& {a} \& $\txid_2$ \\
  {a} \& $\left\{\txid_1\right\}$ \& {a} \& $\emptyset$\\
};

\tikzvalue{versiony-1-1}{versiony-2-1}{locy-v0}{$\val_0$};
\tikzvalue{versiony-1-3}{versiony-2-3}{locy-v1}{$\val_2$};
\end{centertikz}%
\vspace{5pt}
\caption{Write skew, disallowed by \(\SER\)}
\label{fig:ser-disallowed}
\end{subfigure}%
&
\begin{subfigure}{0.30\textwidth}
\begin{centertikz}
\node(locx) {$\ke_1 \mapsto$};
\matrix(versionx) [version list, column 2/.style={text width=10mm}]
    at ([xshift=\tikzkvspace]locx.east) {
    {a} \& $\txid_0$ \& {a} \& $\txid$ \& {a} \& $\txid'$\\
    {a} \& $\{\txid, \txid'\}$ \& {a} \& $\emptyset$ \& {a} \& $\emptyset$ \\
};
\tikzvalue{versionx-1-1}{versionx-2-1}{locx-v0}{$0$};
\tikzvalue{versionx-1-3}{versionx-2-3}{locx-v1}{$1$};
\tikzvalue{versionx-1-5}{versionx-2-5}{locx-v2}{$1$};
\end{centertikz}
\vspace{5pt}
\caption{Lost update, disallowed by \(\UA\)}
\end{subfigure}
\\
\hline
\end{tabular}
%
%
%
%
\phantom{x}\vspace{7pt}
\begin{tabular}{@{} c | c @{}}
\phantom{-}& \phantom{-} \\
\begin{subfigure}{0.42\textwidth}
\begin{centertikz}%
%Location x
\node(locx) {$\ke_1 \mapsto$};

\matrix(versionx) [version list,,column 2/.style={text width=10mm},column 4/.style={text width=10mm}]
    at ([xshift=\tikzkvspace]locx.east) {
    {a} \& $\txid_0$ \& {a} \& $\txid$\\
    {a} \& $\Set{\txid_{\cl_2}^{1}}$ \& {a} \& $\Set{\txid_{\cl_1}^{1}}$ \\
};
\tikzvalue{versionx-1-1}{versionx-2-1}{locx-v0}{$\val_0$};
\tikzvalue{versionx-1-3}{versionx-2-3}{locx-v1}{$\val_1$};

%Location y
\path (versionx.east) + (1,0) node (locy) {$\ke_2 \mapsto$};
\matrix(versiony) [version list,column 2/.style={text width=10mm},column 4/.style={text width=10mm}]
   at ([xshift=\tikzkvspace]locy.east) {
  {a} \& $\txid_0$ \& {a} \& $\txid'$ \\
    {a} \& $\Set{\txid_{\cl_1}^{2}}$ \& {a} \& $\Set{\txid_{\cl_2}^{2}}$ \\
};

\tikzvalue{versiony-1-1}{versiony-2-1}{locy-v0}{$\val_0$};
\tikzvalue{versiony-1-3}{versiony-2-3}{locy-v1}{$\val_2$};
\end{centertikz}%
\vspace{5pt}
\caption{Long fork, disallowed by \(\CP\)}
\label{fig:cp-disallowed-2}
\label{fig:cp-disallowed}
\end{subfigure}
&
\begin{subfigure}{0.542\textwidth}%
\begin{centertikz}%
%Location x
\node(locx) {$\ke_1 \mapsto$};

\matrix(versionx) [version list,column 2/.style={text width=8mm}]
    at ([xshift=\tikzkvspace]locx.east) {
    {a} \& $\txid_0$ \& {a} \& $\txid_1$ \& {a} \& $\txid_2$\\
    {a} \& $\Set{\txid_4}$ \& {a} \& $\emptyset$ \& {a} \& $\emptyset$\\
};
\tikzvalue{versionx-1-1}{versionx-2-1}{locx-v0}{$\val_0$};
\tikzvalue{versionx-1-3}{versionx-2-3}{locx-v1}{$\val_1$};
\tikzvalue{versionx-1-5}{versionx-2-5}{locx-v1}{$\val_2$};
%Location y
\path (versionx.east) + (1,0) node (locy) {$\ke_2 \mapsto$};
\matrix(versiony) [version list,column 2/.style={text width=8mm},column 4/.style={text width=8mm}]
   at ([xshift=\tikzkvspace]locy.east) {
       {a} \& $\txid_0$ \& {a} \& $\txid_3$ \& {a} \& $\txid_4$ \\
       {a} \& $\Set{\txid_2}$ \& {a} \& $\Set{\txid_4}$ \& {a} \& $\emptyset$\\
};

\tikzvalue{versiony-1-1}{versiony-2-1}{locy-v0}{$\val_0$};
\tikzvalue{versiony-1-3}{versiony-2-3}{locy-v1}{$\val_1$};
\tikzvalue{versiony-1-5}{versiony-2-5}{locy-v2}{$\val_2$};

%%Location z
%\path (versiony.east) + (1,0) node (locz) {$\ke_3 \mapsto$};
%\matrix(versionz) [version list,column 2/.style={text width=7mm}]
   %at ([xshift=\tikzkvspace]locz.east) {
 %{a} & $\txid_0$ & {a} & $\txid_3$ & {a} & $\txid_4$ \\
  %{a} & $\emptyset$ & {a} & $\emptyset$ & {a} & $\emptyset$\\
%};

%\tikzvalue{versionz-1-1}{versionz-2-1}{locz-v0}{$\val_0$};
%\tikzvalue{versionz-1-3}{versionz-2-3}{locz-v1}{$\val_1$};
%\tikzvalue{versionz-1-5}{versionz-2-5}{locz-v2}{$\val_2$};

%%Location w
%\path (versionz.east) + (1,0) node (locw) {$\ke_4 \mapsto$};
%\matrix(versionw) [version list,column 2/.style={text width=7mm}]
    %at ([xshift=\tikzkvspace]locw.east) {
    %{a} & $\txid_0$ & {a} & $\txid_1$ \\
    %{a} & $\{\txid_4\}$ & {a} & $\emptyset$ \\
%};
%\tikzvalue{versionw-1-1}{versionw-2-1}{locw-v0}{$\val_0$};
%\tikzvalue{versionw-1-3}{versionw-2-3}{locw-v1}{$\val_1$};
\end{centertikz}
\vspace{5pt}
\caption{Allowed by \( \UA \) and \( \CP \) but disallowed by \(\SI\)}%
\label{fig:si-disallowed}%
\end{subfigure} \\
\hline
\end{tabular}
%\begin{tabular}{@{}c @{} c @{}}
%\begin{minipage}{0.4\textwidth}
%\begin{subfigure}{\textwidth}
%\begin{centertikz}
%%Location x
%\node(locx) {$\ke_1 \mapsto$};
%
%\matrix(versionx) [version list,,column 2/.style={text width=8mm},column 4/.style={text width=7mm}]
%    at ([xshift=\tikzkvspace]locx.east) {
%    {a} & $\txid_0$ & {a} & $\txid_{\cl}^{1}$\\
%    {a} & $\left\{\txid_{\cl'}^{2}\right\}$ & {a} & $\emptyset$ \\
%};
%\tikzvalue{versionx-1-1}{versionx-2-1}{locx-v0}{$\val_0$};
%\tikzvalue{versionx-1-3}{versionx-2-3}{locx-v1}{$\val_1$};
%
%%Location y
%\path (locx.south) + (0,\tikzkeyspace) node (locy) {$\ke_2 \mapsto$};
%\matrix(versiony) [version list,column 2/.style={text width=8mm},column 4/.style={text width=7mm}]
%   at ([xshift=\tikzkvspace]locy.east) {
% {a} & $\txid_0$ & {a} & $\txid_{\cl'}^1$ \\
%  {a} & $\left\{\txid_{cl}^{2}\right\}$ & {a} & $\emptyset$\\
%};
%
%\tikzvalue{versiony-1-1}{versiony-2-1}{locy-v0}{$\val_0$};
%\tikzvalue{versiony-1-3}{versiony-2-3}{locy-v1}{$\val_2$};
%
%\end{centertikz}
%\caption{Disallowed by \(\CP\)}
%\label{fig:cp-disallowed-2}
%\end{subfigure}
%
%\begin{subfigure}{\textwidth}
%\begin{centertikz}
%%Location x
%\node(locx) {$\ke_1 \mapsto$};
%
%\matrix(versionx) [version list,column 2/.style={text width=7mm},column 4/.style={text width=7mm}]
%    at ([xshift=\tikzkvspace]locx.east) {
%    {a} & $\txid_0$ & {a} & $\txid_1$\\
%    {a} & $\left\{\txid_2\right\}$ & {a} & $\emptyset$ \\
%};
%\tikzvalue{versionx-1-1}{versionx-2-1}{locx-v0}{$\val_0$};
%\tikzvalue{versionx-1-3}{versionx-2-3}{locx-v1}{$\val_1$};
%
%%Location y
%\path (locx.south) + (0,\tikzkeyspace) node (locy) {$\ke_2 \mapsto$};
%\matrix(versiony) [version list,column 2/.style={text width=7mm},column 4/.style={text width=7mm}]
%   at ([xshift=\tikzkvspace]locy.east) {
% {a} & $\txid_0$ & {a} & $\txid_2$ \\
%  {a} & $\left\{\txid_1\right\}$ & {a} & $\emptyset$\\
%};
%
%\tikzvalue{versiony-1-1}{versiony-2-1}{locy-v0}{$\val_0$};
%\tikzvalue{versiony-1-3}{versiony-2-3}{locy-v1}{$\val_2$};
%\end{centertikz}
%\caption{Disallowed by \(\SER\)}
%\label{fig:ser-disallowed}
%\end{subfigure}
%
%\end{minipage}
%
%&
%\begin{subfigure}{0.55\textwidth}%
%\begin{centertikz}%
%%Location x
%\node(locx) {$\ke_1 \mapsto$};
%
%\matrix(versionx) [version list,column 2/.style={text width=7mm}]
%    at ([xshift=\tikzkvspace]locx.east) {
%    {a} & $\txid_0$ & {a} & $\txid_1$ & {a} & $\txid_2$\\
%    {a} & $\emptyset$ & {a} & $\emptyset$ & {a} & $\emptyset$\\
%};
%\tikzvalue{versionx-1-1}{versionx-2-1}{locx-v0}{$\val_0$};
%\tikzvalue{versionx-1-3}{versionx-2-3}{locx-v1}{$\val_1$};
%\tikzvalue{versionx-1-5}{versionx-2-5}{locx-v1}{$\val_2$};
%%Location y
%\path (locx.south) + (0,\tikzkeyspace) node (locy) {$\ke_2 \mapsto$};
%\matrix(versiony) [version list,column 2/.style={text width=7mm}]
%   at ([xshift=\tikzkvspace]locy.east) {
% {a} & $\txid_0$ & {a} & $\txid_3$ \\
%  {a} & $\left\{\txid_2\right\}$ & {a} & $\emptyset$\\
%};
%
%\tikzvalue{versiony-1-1}{versiony-2-1}{locy-v0}{$\val_0$};
%\tikzvalue{versiony-1-3}{versiony-2-3}{locy-v1}{$\val_1$};
%
%%Location z
%\path (locy.south) + (0,\tikzkeyspace) node (locz) {$\ke_3 \mapsto$};
%\matrix(versionz) [version list,column 2/.style={text width=7mm}]
%   at ([xshift=\tikzkvspace]locz.east) {
% {a} & $\txid_0$ & {a} & $\txid_3$ & {a} & $\txid_4$ \\
%  {a} & $\emptyset$ & {a} & $\emptyset$ & {a} & $\emptyset$\\
%};
%
%\tikzvalue{versionz-1-1}{versionz-2-1}{locz-v0}{$\val_0$};
%\tikzvalue{versionz-1-3}{versionz-2-3}{locz-v1}{$\val_1$};
%\tikzvalue{versionz-1-5}{versionz-2-5}{locz-v2}{$\val_2$};
%
%%Location w
%\path (locz.south) + (0,\tikzkeyspace) node (locw) {$\ke_4 \mapsto$};
%\matrix(versionw) [version list,column 2/.style={text width=7mm}]
%    at ([xshift=\tikzkvspace]locw.east) {
%    {a} & $\txid_0$ & {a} & $\txid_1$ \\
%    {a} & $\{\txid_4\}$ & {a} & $\emptyset$ \\
%};
%\tikzvalue{versionw-1-1}{versionw-2-1}{locw-v0}{$\val_0$};
%\tikzvalue{versionw-1-3}{versionw-2-3}{locw-v1}{$\val_1$};
%\end{centertikz}%
%\caption{Disallowed by \(\SI\)}%
%\label{fig:si-disallowed}%
%\end{subfigure} \\
%\end{tabular}
\hrulefill
\vspace*{-5pt}
\caption{Behaviours disallowed under different consistency models}
\label{fig:anomalies}
\vspace*{-10pt}
\end{figure*}
