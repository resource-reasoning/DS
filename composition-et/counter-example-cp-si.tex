\subsection{Example: \( \CP \) and \( \SI \) is not commutative}
\label{sec:comm-counter-cp-si}
We should the following counter example why \( \CP \) and \( \SI \) are not commutative.
Let consider an initial kv-store \( \mkvs \) (some writers are omitted):
\begin{centertikz}
%Location x
\node(locx) {$\key_1 \mapsto$};
\draw pic at ([xshift=\tikzkvspace]locx.east) {vlist={versionx}{%
    /$0$/$\stub$/$\emptyset$
    , /$1$/$\txid$/$\emptyset$
}};

%Location y
\path (versionx.east) + (1,0) node (locy) {$\key_2 \mapsto$};
\draw pic at ([xshift=\tikzkvspace]locy.east) {vlist={versiony}{%
    /$2$/$\stub$/$\emptyset$
    , /$3$/$\stub$/$\emptyset$
}};
\end{centertikz}
Assume two clients, \( \cl_1 \) and \( \cl_2 \), want to read the two keys \( \key_1 \) and \( \key_2 \).
Let assume the first client \( cl_1 \) initially has view 
\( \vi_1 = \Set{\key_1 \mapsto \Set{0}, \key_2 \mapsto \Set{0}} \)
With the view, we have the fingerprint for the client \( \fp_1 = \Set{(\otR, \key_1,0), (\otR, \key_2,2)} \),
which leads to the final kv-store \( \mkvs_1 \):
\begin{centertikz}
%Location x
\node(locx) {$\key_1 \mapsto$};
\draw pic at ([xshift=\tikzkvspace]locx.east) {vlist={versionx}{%
    /$0$/$\stub$/$\Set{\txid_1}$
    , /$1$/$\txid$/$\emptyset$
}};

%Location y
\path (versionx.east) + (1,0) node (locy) {$\key_2 \mapsto$};
\draw pic at ([xshift=\tikzkvspace]locy.east) {vlist={versiony}{%
    /$2$/$\stub$/$\Set{\txid_1}$
    , /$3$/$\stub$/$\emptyset$
}};
\end{centertikz}
Assume the view remains the same afterwards.
It is easy to see \( \ET_\CP \vdash (\mkvs,\vi_1) \csat \fp_1 : (\mkvs_1,\vi_1)\), and also for \( \ET_\SI \).

Now for the second client \( \cl_2 \), assume the view 
\( \vi_2 = \Set{\key_1 \mapsto \Set{0,1}, \key_2 \mapsto \Set{0}} \),
which leads to the fingerprint \( \fp_2 = \Set{(\otR, \key_1,1), (\otR, \key_2,2)} \),
and the kv-store \( \mkvs_2 \):
\begin{centertikz}
%Location x
\node(locx) {$\key_1 \mapsto$};
\draw pic at ([xshift=\tikzkvspace]locx.east) {vlist={versionx}{%
    /$0$/$\stub$/$\Set{\txid_1}$
    , /$1$/$\txid$/$\Set{\txid_2}$
}};

%Location y
\path (versionx.east) + (1,0) node (locy) {$\key_2 \mapsto$};
\draw pic at ([xshift=\tikzkvspace]locy.east) {vlist={versiony}{%
    /$2$/$\stub$/$\Set{\txid_1,\txid_2}$
    , /$3$/$\stub$/$\emptyset$
}};
\end{centertikz}
It is trivial that \( \ET_\CP \vdash (\mkvs_1,\vi_2) \csat \fp_2 : (\mkvs_2,\vi_2)\), and also for \( \ET_\SI \).

Commutative allows to swap two fingerprints from different clients and still yields the same kv-store.
It is not the case here.
If we let \( \fp_2 \) commits first we have the following kv-store \( \mkvs'_2 \):
\begin{centertikz}
%Location x
\node(locx) {$\key_1 \mapsto$};
\draw pic at ([xshift=\tikzkvspace]locx.east) {vlist={versionx}{%
    /$0$/$\stub$/$\emptyset$
    , /$1$/$\txid$/$\Set{\txid_2}$
}};

%Location y
\path (versionx.east) + (1,0) node (locy) {$\key_2 \mapsto$};
\draw pic at ([xshift=\tikzkvspace]locy.east) {vlist={versiony}{%
    /$2$/$\stub$/$\Set{\txid_2}$
    , /$3$/$\stub$/$\emptyset$
}};
\end{centertikz}
Over the \( \mkvs'_2 \), the view \( \vi_1 \) is no longer valid because in \( \ET_\CP \):
\[
0 \in \vi_1(\key_2)  
\wedge \wtOf(\mkvs(\key_1, 1)) \toEDGE{(((\SO \cup \WR_{\mkvs}) ; \RW_{\mkvs}^?) \cup \WW_{\mkvs})^{+}} \wtOf(\mkvs(\key_2, 0)) 
\]
but \( i \notin \vi_1(\key_1)\).
It is similar for \( \ET_\SI \).

