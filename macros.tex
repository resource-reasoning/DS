%**********************************************************************************************************************************
% Note: this file is shared between several documents, please do not delete any macros.
% Maintained by Shale Xiong <sx14@ic.ac.uk>
%**********************************************************************************************************************************


%**********************************************************************************************************************************
% Styles and Short-hand
%**********************************************************************************************************************************
% Text & typesetting
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\rl}[1]{\textsc{#1}}
\newcommand{\sort}[1]{\protect\scalebox{0.9}{\textsc{#1}}}
\newcommand{\predFont}[1]{\ensuremath{\mathtt{#1}}}
\newcommand{\funcFont}[1]{\ensuremath{\mathsf{#1}}}
\newcommand{\code}[1]{\texttt{#1}}
\newcommand{\qqquad}{\qquad\quad}
\newcommand{\qqqquad}{\qquad\qquad}
\newenvironment{rclarray}[1][]{%
    \begin{array}[#1]{r c l}
}{%
    \end{array}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Define Block
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\defin}{\text{Def.}\xspace}
\newcommand{\defref}[1]{\defin\ref{#1}}
\newcommand{\fig}{\text{Fig.}\xspace}
\newcommand{\figref}[1]{\fig\ref{#1}}
\newcommand{\tabin}{\text{Table}\xspace}
\newcommand{\tabref}[1]{\tabin\ref{#1}}
\newcommand{\thmin}{\text{Theorem}\xspace}
\newcommand{\thmref}[1]{\thmin\ref{#1}}
\newcommand{\equin}{\text{Eq.}\xspace}
\newcommand{\equref}[1]{\equin\eqref{#1}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Short-hand
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\funcn}[1]{\funcFont{#1}}
\newcommand{\func}[2]{\funcn{#1}\left(#2\right)}
\newcommand{\predn}[1]{\predFont{#1}}
\newcommand{\pred}[2]{\predn{#1}\left(#2\right)}
\newcommand{\case}[2]{\begin{itemize} \item \textbf{#1} {#2}. \end{itemize}}
\newcommand{\caseB}[1]{\case{Base Case}{#1}}
\newcommand{\caseI}[1]{\case{Inductive Case}{#1}}
\newcommand{\ih}{I.H.\xspace}
\newcommand{\ie}{i.e.\xspace}



%**********************************************************************************************************************************
% Programming Logic in general
%**********************************************************************************************************************************
\newcommand{\pre}{P}
\newcommand{\post}{Q}
\newcommand{\cmd}{\mathbb{C}}
\newcommand{\triple}[3]{ %
    \left\{ \begin{array}{@{}l@{}} #1 \end{array} \right\}%
    \ #2 \ %
    \left\{ \begin{array}{@{}l@{}} #3 \end{array} \right\}%
}

%**********************************************************************************************************************************
% For snapshot work
%**********************************************************************************************************************************



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%maths
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% General notations
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\stub}{-}
\newcommand{\anyval}{\_}
\newcommand{\for}[1]{\forall #1.\;}
\newcommand{\exsts}[1]{\exists #1.\;}
\newcommand{\undef}{\uparrow}
\newcommand{\isdef}{\downarrow}
\newcommand{\iffdef}{\ensuremath{\stackrel{\textnormal{def}}{\Longleftrightarrow}}}
\newcommand{\defiff}{\iffdef}
\newcommand{\defeq}{\triangleq}
\newcommand{\eqdef}{\defeq}
\newcommand{\Nat}{\mathbb{N}}
\newcommand{\nat}{n}
\newcommand{\Real}{\mathbb{R}}
\newcommand{\Set}[1]{\left\{ #1 \right\}}
\newcommand{\Setcon}[2]{\myset{#1}{#2} }
\newcommand{\myset}[2]{
	\left\{
	\begin{array}{@{} l | l @{}}
		\begin{array}{@{} l @{}}
			#1
		\end{array}
		& 
		\begin{array}{@{} l @{}}
			#2
		\end{array}
	\end{array}
	\right\}
}
\newcommand{\List}[1]{\left[ #1 \right]}
\newcommand{\unitelem}[1]{\textbf{1}_{#1}}
\newenvironment{formulea}{%
    \left(
    \begin{array}{@{}l@{}}
}{%
    \end{array}
    \right)
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Operators
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\DeclareMathOperator{\dom}{dom}
\newcommand{\remapsto}[2]{{\left[#1 \mapsto #2\right]}}
\newcommand{\powerset}[1]{\mathcal{P}(#1)}
\newcommand{\parfun}{\rightharpoonup}
\newcommand{\parfinfun}{\overset{fin}{\rightharpoonup}}
\newcommand{\compose}[1]{\bullet_{#1}}
\newcommand{\denote}[1]{\left\llbracket \begin{array}{@{}l@{}} #1 \end{array}\right\rrbracket}
\newcommand{\eval}[2]{\denote{#1}_{#2}}
\newcommand{\projection}[1]{\!\!\downharpoonright_{#1}}
\newcommand{\flatten}[2][]{\left\lfloor #2 \right\rfloor_{#1}}
\newcommand{\erase}[2][]{\ensuremath{\llfloor #2 \rrfloor_{#1}}}
\newcommand{\clps}[2][]{\erase[#1]{#2}}
\newcommand{\lift}[2][]{\ensuremath{\llceil #2 \rrceil_{#1}}}
\newcommand{\orth}[1]{\ensuremath{{#1}^{\bot}}}
\newcommand{\ord}{\sqsubseteq}
\newcommand{\closure}[1]{{#1}^{*}}
\newcommand{\effect}[1]{\Delta #1}
\newcommand{\transfersto}[1][]{\mathbin{\leadsto_{#1}}}
\newcommand{\mrgop}{\mathbin{\bowtie}}
\newcommand{\mergeName}[1][]{\funcn{merge}_{#1}}
\newcommand{\mrg}[2][]{\func{\mergeName[#1]}{#2}}
\newcommand{\agreeName}[1][]{\funcn{agree}_{#1}}
\newcommand{\agree}[2]{\pred{\agreeName[#1]}{#2}}
\newcommand{\wfName}[1][]{\predn{wf}_{#1}}
\newcommand{\wf}[2][]{\pred{\wfName[#1]}{#2}}
\newcommand{\sub}[2]{\left[ \sfrac{#2}{#1} \right]}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Programming language 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% General Meta-variables
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\Addr}{\sort{Addr}}
\newcommand{\Loc}{\Addr}
\newcommand{\addr}{a}
\newcommand{\loc}{\addr}
\newcommand{\Val}{\sort{Val}}
\newcommand{\val}{v}
\newcommand{\Var}{\sort{Var}}
\newcommand{\var}{\pvar{x}}
\newcommand{\Timestamp}{\sort{TimeStamp}}
\newcommand{\ts}{t}
\newcommand{\TransID}{\sort{TransID}}
\newcommand{\tsid}{\alpha}
\newcommand{\ThreadID}{\sort{ThreadID}}
\newcommand{\thid}{i}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Stack
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\Stack}{\sort{Stack}}
\newcommand{\stack}{\ensuremath{\sigma}}
\newcommand{\stk}{\stack}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Expressions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\Expressions}{\sort{Expr}}
\newcommand{\Expr}{\Expressions}
\newcommand{\expr}{\mathbb{E}}
\newcommand{\evalE}[2][\stk]{\eval{#2}{#1}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Syntax Booleans
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\Booleans}{\sort{Bool}}
\newcommand{\bool}{\mathbb{B}}
\newcommand{\true}{\texttt{true}}
\newcommand{\false}{\texttt{false}}
\newcommand{\boolnot}{\texttt{not}~}
\newcommand{\booland}{\mathbin{\texttt{and}}}
\newcommand{\boolor}{\mathbin{\texttt{or}}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Syntax Truncations & Programs 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\Transactions}{\sort{Trans}}
\newcommand{\trans}{\mathbb{T}}
\newcommand{\Programs}{\sort{Prog}}
\newcommand{\prog}{\mathbb{P}}
\newcommand{\pskip}{\mathtt{skip}}
\newcommand{\pvar}[1]{\texttt{#1}}
\newcommand{\pass}[2]{#1:=#2}
\newcommand{\passign}[2]{#1:=#2}
\newcommand{\pmutate}[2]{[#1]:=#2}
\newcommand{\pderef}[2]{#1:=[#2]}
\newcommand{\palloc}[2]{#1 \mathtt{\ :=\ } \mathtt{alloc}(#2)}
\newcommand{\pseq}{\mathbin{;}}
\newcommand{\pchoice}{\mathbin{+}}
\newcommand{\prepeat}{^{*}}
\newcommand{\ppar}{\mathbin{\|}}
\newenvironment{transaction}{%
    \left\lbrack%
    \begin{array}{@{}l@{}}
}{%
    \end{array}%
    \right\rbrack
}
\newcommand{\ptrans}[1]{%
    \begin{transaction} #1 \end{transaction}%
}
\newcommand{\pruntrans}[2]{%
    \left\lbrack \! \left\lbrack \begin{array}{@{}l@{}} #1%
    \end{array} \right\rbrack\!  \right\rbrack_{#2}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Syntax intermediate Programs 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\IntermediatePrograms}{\sort{IProg}}
\newcommand{\iprog}{\prog^{\uparrow}}
\newcommand{\pwait}[1]{\texttt{wait}(#1)}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Labels for reduction 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\Translabel}{\sort{Label}}
\newcommand{\translabel}{\iota}
\newcommand{\lb}{\translabel}
\newcommand{\lbID}{{\texttt{id}}}
\newcommand{\lbF}[1]{\texttt{fork}(#1)}
\newcommand{\lbC}[1]{\texttt{cmt}(#1)}
\newcommand{\lbJ}[1]{\texttt{join}(#1)}
\newcommand{\lbS}[1]{\texttt{st}(#1)}
\newcommand{\lbRS}[1]{\texttt{rst}(#1)}
\newcommand{\setlabels}{\mathcal{L}}
\newcommand{\ExtTranslabel}{\sort{EXLabel}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Fingerprints
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\Fingerprint}{\sort{FingerPrint}}
\newcommand{\fp}{f}
\newcommand{\fpW}{\texttt{w}}
\newcommand{\fpR}{\texttt{r}}
\newcommand{\addR}{\ensuremath{\stackrel{\fpR}{\hookleftarrow}}}
\newcommand{\addW}{\ensuremath{\stackrel{\fpW}{\hookleftarrow}}}
\newcommand{\addFPR}[1]{#1 \addR}
\newcommand{\addFPW}[1]{#1 \addW}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Fingerprint heaps
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\FPHeaps}{\sort{FPHeap}}
\newcommand{\composeFP}{\compose{\scalebox{.5}{\(\fph\)}}}
\newcommand{\unitFP}{\unitelem{\scalebox{.5}{\(\fph\)}}}
\newcommand{\fphp}{\ensuremath{\mathbf{h}}}
\newcommand{\fph}{\fphp}
\newcommand{\setfph}{\mathbf{H}}
\newcommand{\fphVal}[1][\fph]{#1^{\textsf{v}}}
\newcommand{\fphFP}[1][\fph]{#1^{\textsf{fp}}}
\newcommand{\clpsFP}[1]{\clps{#1}_{\fph}}
\newcommand{\eraseFPH}[1]{\erase[\fph]{#1}}
\newcommand{\mergeFP}[2]{\mrg[\scalebox{.5}{\(\fph\)}]{#1,#2}}
%\newcommand{\readOnlyName}{\funcFont{RO}}
%\newcommand{\readOnly}[1]{\func{\readOnlyName}{#1}}
\newcommand{\readOnly}[1]{\ensuremath{\left\lfloor#1\right\rfloor_{\mathsf{ro}}}}
\newcommand{\heapOnly}[1]{\ensuremath{\left\lfloor#1\right\rfloor_{\h}}}
\newcommand{\wsName}{\funcFont{ws}}
\newcommand{\ws}[1]{\func{\wsName}{#1}}
\newcommand{\rsName}{\funcFont{rs}}
\newcommand{\rs}[1]{\func{\rsName}{#1}}
\newcommand{\mergeVAL}[2]{\mrg[\scalebox{.8}{\(\val\)}]{#1,#2}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Event tags
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\ETags}{\sort{ETag}}
\newcommand{\etag}{e}
\newcommand{\etS}{\texttt{S}}
\newcommand{\etE}{\texttt{E}}
\newcommand{\etR}{\texttt{R}}
\newcommand{\etW}{\texttt{W}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Time-stamp heaps
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\TSHeaps}{\sort{TSHeap}}
\newcommand{\composeTS}{\compose{\scalebox{.5}{\(\tshp\)}}}
\newcommand{\unitTS}{\unitelem{\scalebox{.5}{\(\tshp\)}}}
\newcommand{\tshp}{\mathit{H}}
\newcommand{\tsh}{\tshp}
\newcommand{\wfH}[1]{\wf[\scalebox{.5}{\(\tshp\)}]{#1}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Reduction relation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\toL}{\transfersto[l]}
\newcommand{\toT}[1]{\overset{#1}{\transfersto[t]}}
\newcommand{\toG}[1]{\overset{#1}{\transfersto[g]}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Thread level reduction
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\snapshotName}{\funcn{snapshot}}
\newcommand{\snapshot}[2]{\func{\snapshotName}{#1, #2}}
\newcommand{\cancommitName}{\predn{can\_commit}}
\newcommand{\cancommit}[4]{\pred{\cancommitName}{#1, #2, #3, #4}}
\newcommand{\wfhistName}{\predn{wf\_hist}}
\newcommand{\wfhist}[4]{\pred{\wfhistName}{#1, #2, #3, #4}}
\newcommand{\consistentName}{\funcn{consistent}}
\newcommand{\consistent}[4]{\func{\consistentName}{#1, #2, #3, #4}}
\newcommand{\commitName}{\funcn{commit}}
\newcommand{\commit}[6]{\func{\commitName}{#1, #2, #3, #4, #5, #6}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Thread pools
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\TPool}{\sort{TPool}}
\newcommand{\threadpool}{\eta}
\newcommand{\thpl}{\threadpool}








%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%logic
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% General
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\sep}{\mathbin{*}}
\newcommand{\pointsto}{\mapsto}
\newcommand{\asstrue}{\textnormal{true}}
\newcommand{\True}{\asstrue}
\newcommand{\assfalse}{\textnormal{false}}
\newcommand{\False}{\assfalse}
\newcommand{\assemp}{\textnormal{emp}}
\newcommand{\emp}{\assemp}
\newcommand{\Emp}{\assemp}
\newcommand{\RegionID}{\sort{RegionID}}
\newcommand{\regionid}{r}
\newcommand{\rid}{\regionid}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Capabilities
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\Kaps}{\sort{Kap}}
\newcommand{\kap}{\kappa}
\newcommand{\composeK}{\ensuremath{\compose{\kap}}}
\newcommand{\unitK}{\ensuremath{\unitelem{\kap}}}
\newcommand{\Caps}{\sort{Cap}}
\newcommand{\ca}{\ensuremath{\mathit c}}
\newcommand{\composeC}{\ensuremath{\compose{\ca}}}
\newcommand{\unitC}{\ensuremath{\unitelem{\ca}}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Logical Expressions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\V}[1]{\textsc{\lowercase{#1}}}
\newcommand{\LVar}{\sort{LVar}}
\newcommand{\lvar}{\V{x}}
\newcommand{\LExpr}{\sort{LExpr}}
\newcommand{\lexpr}{\ensuremath{\mathit e}}
\newcommand{\LEnv}{\sort{LEnv}}
\newcommand{\lenv}{\iota}
\newcommand{\evalLE}[2][\lenv, \stk]{\eval{#2}{#1}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Local State
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\LStates}{\sort{LState}}
\newcommand{\ls}{\ensuremath{\mathbf{l}}}
\newcommand{\composeLS}{\compose{\ls}}
\newcommand{\unitLS}{\unitelem{\ls}}
\newcommand{\clpsLS}[1]{\clps{#1}_{\ls}}
\newcommand{\lsFPH}[1]{\ensuremath{#1_{\fph}}}
\newcommand{\lsCAP}[1]{\ensuremath{#1_{\ca}}}
\newcommand{\mergeLS}[3]{\mrg[\ls]{#1, #2, #3}}
\newcommand{\eraseLS}[1]{\erase[\ls]{#1}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Local Assertions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\fpt}[1]{\pointsto_{#1}}
\newcommand{\fptEMP}{\fpt{\emptyset}}
\newcommand{\fptR}{\fpt{\{\fpR\}}}
\newcommand{\fptW}{\fpt{\{\fpW\}}}
\newcommand{\fptRW}{\fpt{\{\fpR, \fpW\}}}
\newcommand{\LAst}{\sort{LAst}}
\newcommand{\last}{p}
\newcommand{\lpre}{\last}
\newcommand{\lpost}{q}
\newcommand{\lframe}{r}
\newcommand{\lrid}{\V{r}}
\newcommand{\perm}[1]{\left[#1\right]}
\newcommand{\cass}[2]{\perm{#1}^{#2}}
\newcommand{\cassL}[1]{\perm{#1}^{\V l}}
\newcommand{\cassS}[1]{\perm{#1}^{\V s}}
\newcommand{\evalLS}[2][\lenv, \stk]{\eval{#2}{#1}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Actions and Interference
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\Actions}{\sort{Action}}
\newcommand{\action}{\textnormal{a}}
\newcommand{\Interference}{\sort{Inter}}
\newcommand{\intf}{\mathcal I}
\newcommand{\inter}{\intf}
\newcommand{\mclose}{^{\mrgop}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Logical State
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\PHeap}{\sort{PHeap}}
\newcommand{\Heaps}{\sort{Heap}}
\newcommand{\php}{\ensuremath{\mathit{h}}}
\newcommand{\h}{\php}
\newcommand{\composeH}{\compose{\php}}
\newcommand{\unitH}{\unitelem{\php}}
\newcommand{\LGStates}{\sort{LGState}}
\newcommand{\lgs}{\ensuremath{\mathit l}}
\newcommand{\composeLGS}{\compose{\scalebox{.5}{\(\mathsf{L}\)}}}
\newcommand{\unitLGS}{\unitelem{\scalebox{.5}{\(\mathsf{L}\)}}}
\newcommand{\lgsTSH}[1]{\ensuremath{#1^{\mathsf{H}}}}
\newcommand{\lgsCAP}[1]{\ensuremath{#1^{\mathsf{C}}}}
\newcommand{\conflictName}{\predn{conflict}}
\newcommand{\conflict}[3]{\pred{\conflictName}{#1, #2, #3}}
\newcommand{\liftLGS}[1]{\lift[\lgs]{#1}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Worlds
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\SStates}{\sort{SState}}
\newcommand{\gs}{\ensuremath{\mathit s}}
\newcommand{\composeS}{\compose{\gs}}
\newcommand{\composeEq}{\compose{=}}
\newcommand{\unitS}{\unitelem{\gs}}
\newcommand{\liftGS}[1]{\lift[\gs]{#1}}
\newcommand{\World}{\sort{World}}
\newcommand{\world}{\ensuremath{\mathit{w}}}
\newcommand{\w}{\world}
\newcommand{\setworld}{W}
\newcommand{\composeW}{\compose{\world}}
\newcommand{\unitW}{\unitelem{\world}}
\newcommand{\flattenW}[1]{\flatten[\world]{#1}}
\newcommand{\wfW}[1]{\wf[\world]{#1}}
\newcommand{\liftW}[1]{\lift[\world]{#1}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Interference Assertions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\IAst}{\sort{IAst}}
\newcommand{\intass}{I}
\newcommand{\evalI}[2][\lenv, \stk]{\eval{#2}{#1}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Global Assertions and Worlds
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\pt}{\pointsto}
\newcommand{\Ast}{\sort{Ast}}
\newcommand{\gpre}{P}
\newcommand{\gpost}{Q}
\newcommand{\boxass}[3]{%
    \fbox{%
        \(%
        \scalebox{.8}{\(#1\)}%
        \)%
    }^{\,#2}_{\,#3}%
}
\newcommand{\evalW}[2][\lenv, \stk]{\eval{#2}{#1}}
\newcommand{\evalAUX}[2][\lenv, \stk]{%
    \left\{\!\!\left[ %
    \begin{array}{@{}l@{}}%
    #2%
    \end{array} %
    \right]\!\!\right\}_{#1}%
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Fingerprint Worlds 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\FPWorlds}{\sort{FPWorld}}
\newcommand{\fpw}{\ensuremath{\mathbf{w}}}
\newcommand{\fpgs}{\ensuremath{\mathbf{s}}}
\newcommand{\composeFPGS}{\compose{\fpgs}}
\newcommand{\flattenFW}[1]{\flatten[\fpw]{#1}}
\newcommand{\wfFW}[1]{\wf[\fpw]{#1}}
\newcommand{\mergeFW}[3]{\mrg[\fpw]{#1,#2,#3}}
\newcommand{\mergeFGS}[3]{\mrg[\fpgs]{#1,#2,#3}}
\newcommand{\eraseFW}[1]{\erase[\fpw]{#1}}
\newcommand{\eraseFGS}[1]{\erase[\fpgs]{#1}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% rely and guarantee
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\guar}{\mathit{G}}
\newcommand{\rely}{\mathit{R}}
\newcommand{\relyU}[1][\inter]{\ensuremath{\rely^{u}(#1)}}
\newcommand{\relyE}[1][\inter]{\ensuremath{\rely^{e}(#1)}}
\newcommand{\guarU}[1][\inter]{\ensuremath{\guar^{u}(#1)}}
\newcommand{\guarE}[1][\inter]{\ensuremath{\guar^{e}(#1)}}
\newcommand{\myrely}[1][\inter]{\ensuremath{\mathcal R}(#1)}
\newcommand{\myguar}[1][\inter]{\ensuremath{\mathcal G}(#1)}
\newcommand{\stable}[2]{\pred{stable}{#1,#2}}
\newcommand{\mergeR}[3]{\mrg[\scalebox{.5}{\(\rely\)}]{#1,#2,#3}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Logic Rules
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\tripleEnv}[5]{%
#1 \vdash_{#2} %
    \begin{array}{@{}l} %
    \triple{#3}{#4}{#5} %
    \end{array}%
}
\newcommand{\tripleL}[3]{%
    \tripleEnv{}{l}{#1}{#2}{#3}
}
\newcommand{\tripleG}[3]{%
    \tripleEnv{\inter}{g}{#1}{#2}{#3}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% repartition
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\mrepartition}[4]{ %
    #1 %
    \Rrightarrow^{ %
       \left\{ #3 \right\}%
       \left\{ #4 \right\}%
    } #2
}
\newcommand{\repartition}[5][\inter]{ %
    #1 \vdash \mrepartition{#2}{#3}{#4}{#5}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  Soundness
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\tripleSem}[5]{%
#1 \vDash_{#2} %
    \begin{array}{@{}l} %
    \triple{#3}{#4}{#5} %
    \end{array}%
}
\newcommand{\tripleSemG}[3]{%
    \tripleSem{\inter}{g}{#1}{#2}{#3}
}
\newcommand{\tripleSemL}[3]{%
    \tripleSem{}{l}{#1}{#2}{#3}
}
\newcommand{\Atom}{\sort{Atom}}
\newcommand{\intpSQ}[1]{\eval{#1}{}}
\newcommand{\intpATOM}[1]{\eval{#1}{}}
\newcommand{\reif}[1]{\lfloor #1 \rfloor_{\texttt{rf}}}
















%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Graph
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% General
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\SIGraphs}{\sort{SIGraphs}}
\newcommand{\PGraphs}{\sort{PGraphs}}
\newcommand{\TGraphs}{\sort{TGraphs}}
\newcommand{\sig}{\ensuremath{\mathcal{G}}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Trace
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\Trace}{\sort{Trace}}
\newcommand{\trace}{\ensuremath{\theta}}
\newcommand{\trc}{\trace}
\newcommand{\settrans}{\mathcal{T}}
\newcommand{\settrace}{\Theta}
\newcommand{\settrc}{\settrace}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Edges
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\edgeto}[1]{\overset{#1}{\to}}
\newcommand{\po}{\texttt{po}}
\newcommand{\toPO}{\edgeto{\po}}
\newcommand{\vis}{\texttt{vis}}
\newcommand{\toVIS}{\edgeto{\vis}}
\newcommand{\ptlar}{\texttt{ptlar}}
\newcommand{\toPTLAR}{\edgeto{\ptlar}}
\newcommand{\ar}{\texttt{ar}}
\newcommand{\toAR}{\edgeto{\ar}}








%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Sketch proofs
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\specline}[1]{ { \color{blue} \left\{ \begin{array}{@{}l@{}} #1 \end{array} \right\}} }
\newcommand{\actionline}[2]{ { \color{red} #1 : \left. \begin{array}{@{}l@{}} #2 \end{array} \right.} }
\newcommand{\comment}[1]{\texttt{#1}}
\newcommand{\cell}[2]{#1 \pt #2}
\newcommand{\twocell}[3]{#1 \pt #2, #3}
\newcommand{\threecell}[4]{#1 \pt #2, #3, #4}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Short-hand for programs
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\pifs}[1]{\texttt{if} \, (#1)}
\newcommand{\pifm}{\texttt{else}}
\newcommand{\pif}[3]{\pifs{#1} \  #2 \  \pifm \  #3}
\newcommand{\ploop}[2]{\texttt{while} \, (#1) \  #2}
\newcommand{\pv}[1]{\code{#1}}
\newcommand{\vx}{\pv{x}}
\newcommand{\vvx}{\pv{vx}}
\newcommand{\vy}{\pv{y}}
\newcommand{\vvy}{\pv{vy}}
\newcommand{\vz}{\pv{z}}
\newcommand{\vtmp}{\pv{tmp}}
\newenvironment{parl}{%
    \begin{array}{@{}c || c@{}}
}{%
    \end{array}
}
\newenvironment{session}{%
    \begin{array}{@{}c@{}}
}{%
    \end{array}
}
