\begin{figure}
\[
    \ToProg*{}  
    \IsTyped 
    \begin{gathered}[t]
    (\KVSs \times \ViewEnvs \times \ClientEnvs \times \Programs)
    \times \Labels \times {}
    \\ (\KVSs \times \ViewEnvs \times \ClientEnvs \times \Programs)
     \end{gathered}
\]

\begin{mathpar}
\inferrule[\rProg]{%
    \vi = \vienv(\cl)
    \\ \stk = \clenv(\cl)
    \\ \cmd = \prog(\cl)
    \\ \lb = (\cl,\cdots)
    \\ \ToCmd{\kvs | \vi | \stk | \cmd | \lb ->  \kvs' | \vi' | \stk' | \cmd'  }
}{%
    \ToProg{ \kvs | \vienv | \clenv | \prog | \lb 
        -> \kvs' | \vienv\UpdateFunc{\cl -> \vi'} | \clenv\UpdateFunc{\cl -> \stk'} | \prog\UpdateFunc{\cl -> \cmd'} } 
}%
\end{mathpar}

\hrulefill

\caption{Operational semantics of programs}
\label{fig:program-semantics}
\end{figure}
