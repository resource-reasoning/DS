\section{Litmus Tests}
This is used to test the semantics.
\[
    \begin{session}
        \begin{array}{@{}c || c || c || c@{}}
            \begin{transaction}
                \pderef{\vx}{\loc_x}; \\
                \pifs{\vx=0} \\
                \quad \pmutate{\loc_y}{1}
            \end{transaction} & 
            \begin{transaction}
                \pderef{\vy}{\loc_y}; \\
                \pifs{\vx=0} \\
                \quad \pmutate{\loc_x}{1}
            \end{transaction} & 
            \begin{transaction}
                \pmutate{\loc_x}{2}
            \end{transaction} & 
            \begin{transaction}
                \pmutate{\loc_y}{2}
            \end{transaction} \\
        \end{array}
    \end{session}
\]

Simple merging example.
\[
    \begin{session}
        \begin{array}{@{}c || c @{}}
            \begin{transaction}
                \pderef{\vx}{\loc_x}; \\
                \pifs{\vx=0} \\
                \quad \pmutate{\loc_y}{1}
            \end{transaction} & 
            \begin{transaction}
                \pderef{\vy}{\loc_y}; \\
                \pifs{\vx=0} \\
                \quad \pmutate{\loc_x}{1}
            \end{transaction} 
        \end{array}
    \end{session}
\]

Long fork.
\[
    \begin{session}
        \begin{array}{@{}c || c @{}}
            \begin{session}
                \begin{transaction}
                    \pmutate{\loc_{x}}{1};
                \end{transaction} \\
                \begin{transaction}
                    \pderef{\vx}{\loc_x}; \\
                    \pderef{\vy}{\loc_y}; \\
                    \pifs{\vx=1 \booland \vy = 0} \\
                    \quad \pmutate{\loc_w}{1}
                \end{transaction} 
            \end{session}  &
            \begin{session}
                \begin{transaction}
                    \pmutate{\loc_{y}}{1};
                \end{transaction} \\
                \begin{transaction}
                    \pderef{\vx}{\loc_x}; \\
                    \pderef{\vy}{\loc_y}; \\
                    \pifs{\vx=0 \booland \vy = 1} \\
                    \quad \pmutate{\loc_z}{1}
                \end{transaction} 
            \end{session}
        \end{array}
    \end{session}
\]

Test the rely is ``closed"" correctly, esp.\ location x and y transfer from (0,0) to (2,1).
\[
    \begin{session}
        \begin{array}{@{}c || c || c || c@{}}
            \begin{transaction}
                \pmutate{\loc_x}{1}
            \end{transaction} & 
            \begin{transaction}
                \pifs{\vx=0} \\
                \quad \pmutate{\loc_y}{1}
            \end{transaction} & 
            \begin{transaction}
                \pderef{\vx}{\loc_x}; \\
                \pderef{\vy}{\loc_y}; \\
                \pifs{\vx=1 \booland \vy = 0} \\
                \quad \pmutate{\loc_x}{2}
            \end{transaction} & 
            \begin{transaction}
                anything
            \end{transaction} \\
        \end{array}
    \end{session}
\]

Test the soundness of merge
\[
\begin{session}
    \specline{(0,0)} \\
    \begin{parl}
        \begin{session}
            \specline{(0,0) \lor (3,0)} \\
            \begin{transaction}
                \pifs{\vx = 0} \\
                \pmutate{\vy}{1};
                \pife
            \end{transaction} \\
            \specline{(0,1) \lor (3,0) \lor (3,1)} \\
            \begin{transaction}
                \pifs{\vx = 0} \\
                \pmutate{\vy}{2};
                \pife
            \end{transaction}  \\
            \specline{(0,2) \lor (3,0) \lor (3,1)} \\
        \end{session} &
        \begin{session}
            \specline{(0,0) \lor (0,1) \lor (0,2)} \\
            \begin{transaction}
                \pifs{\vy = 0} \\
                \pmutate{\vx}{3};
                \pife
            \end{transaction} \\
            \specline{(3,0) \lor (0,1) \lor (0,2) 
                {} \lor (3,1) \lor (3,2) } \\
        \end{session} 
    \end{parl} \\
    \specline{(0,2) \lor (3,0) \lor (3,1)} \\
    Miss (3,2)
\end{session}
\]
