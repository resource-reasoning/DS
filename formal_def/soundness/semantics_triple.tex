\subsection{Triple Semantics}

\begin{defn}[Triple semantic]
\label{def:semantic-triple}
\label{def:triple-semantic}
For brevity, \( ( \aexec, \aexec' ) \in \relyU \) if the following holds,
\[
\begin{rclarray}
    ( \aexec, \aexec' ) \in \relyU & \iffdef & 
    \exsts{\w, \w', \evset}  
    \aexec \in \clpsW{\w}
    \land \aexec' \in \clpsW{\w'}
    \land ( \w, \w' ) \in \relyU
    \land \aexec' \in \func{apply}{\aexec, \evset, \como}
\end{rclarray}
\]
Thus, similarly for \( (\aexec,\aexec') \in \Rely \iffdef ( \aexec, \aexec' ) \in \closure{(\relyU)} \).
To take into account of the interleaving, we extend the per-thread semantics with the following rules,
\sx{ To make this properly work, we also need to extend the global semantics, if current threads run rely label, there must be threads reducing their codes }.
\[
    \infer[\rl{TRRely}]{
        \como, \thid \vdash (\thstk, \aexecrun), \prog \ \toT{\lbRELY} (\thstk, \aexecrun'), \prog
    }{
        ( \eraseAEX{\aexecrun}, \eraseAEX{\aexecrun'} ) \in \Rely
    }
\]
Given above the semantics of the triple is as the follows,                                                  
\sx{ type mismatch, gonna fix later }.
\[
\begin{rclarray}
    \tripleSemG{\gpre}{\prog}{\gpost} & \defeq &
    \begin{array}[t]{@{}l@{}}
        \for{ \w,\w',\thid, \thstk, \thstk', \aexecrun,\aexecrun' }  \\
        \quad \w \in \evalW{\gpre} 
        \land \aexecrun \in \clpsW{\w}
        \land \thid, \como \vdash (\thstk, \aexecrun), \prog \toT{\stub}^{*}  (\thstk', \aexecrun'), \pskip \\
        \quad \implies  \w' \in \evalW{\gpost} 
        \land \aexecrun' \in \clpsW{\w'}
    \end{array}
\end{rclarray}
\]
\end{defn}                                         
