\section{Examples\label{sec:example}}

\sx{New observation:
\begin{itemize}
\item We might want to have some assertion to say the initial values of a region.
\item What is the meaning of sequential composition since some consistency model does not have strong session guarantee, maybe the answer is the ``commit'' order.
\item Explain stablisation in a roughly syntactic level.
\end{itemize}
}

\subsection{Single increment and multi-reader.}
\[
    \begin{array}{@{}l@{}}
        \boxass{\V{x} \pt \V{\nat}}{\lrid}{\intass} \\
        \C{Inc} \composeK \C{Inc} \text{ is undefined} \\
        \C{Rd} \text{ is the unit element} \\
    \end{array}
\]
\subsubsection{SER}
\[
    \begin{array}{@{}l@{}}
        \intass : 
        \begin{rclarray}[t]
        \C{Inc} & : & \exsts{\V{m, k}} \Set{(\etR, \V{x}, \V{m}), (\etW, \V{x}, \V{m} + 1)} \mat \V{x} \pt \V{k} \oassto \V{x} \pt \V{k} \\
        \C{Rd}  & : & \exsts{\V{m, k, v}} \Set{(\etR, \V{x}, \V{m})} \mat \V{x} \pt \V{k} \oassto \V{x} \pt \V{k} \\ 
        \end{rclarray} \\
    \end{array}
\]

\[
\begin{session}
\specline{\boxass{\vx \pt 0}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} } \\
\specline{\boxass{\vx \pt 0}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} \sep \cass{\C{Rd}}{\lrid} \sep \cass{\C{Rd}}{\lrid} } \\
\begin{parl}
    \begin{session}
    \specline{\boxass{\vx \pt 0}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} \sep \cass{\C{Rd}}{\lrid} } \\
    \begin{transaction}
        \specline{ \vx \pt 0 } \\
        \pderef{\pvar{a}}{\vx} ; \\
        \specline{ \vx \pt 0 \land \pvar{a} = 0 \sep \Set{(\etR, \vx, 0)} } \\
        \pmutate{\vx}{\pvar{a} + 1} ; \\
        \specline{ \vx \pt 1 \land \pvar{a} = 0 \\
                {} \sep \Set{(\etR, \vx, 0), (\etW, \vx, 1)} } \\
    \end{transaction} \\
    \specline{\boxass{\vx \pt 1}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} \sep \cass{\C{Rd}}{\lrid} } \\
    \begin{transaction}
        \specline{ \vx \pt 1 } \\
        \pderef{\pvar{b}}{\vx} ; \\
        \specline{ \lor \vx \pt 1 \sep \Set{(\etR, \vx, 1)} } \\
    \end{transaction} \\
    \specline{\boxass{\vx \pt 1}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} \sep \cass{\C{Rd}}{\lrid} } \\
    \begin{transaction}
        \specline{ \vx \pt 1 } \\
        \pderef{\pvar{a}}{\vx} ; \\
        \specline{ \vx \pt 1 \land \pvar{a} = 1 \sep \Set{(\etR, \vx, 1)} } \\
        \pmutate{\vx}{\pvar{a} + 1} ; \\
        \specline{ \vx \pt 2 \land \pvar{a} = 1 \\
                {} \sep \Set{(\etR, \vx, 1), (\etW, \vx, 2)} } \\
    \end{transaction} \\
    \specline{\boxass{\vx \pt 2}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} \sep \cass{\C{Rd}}{\lrid} } \\
    \end{session}
    &
    \begin{session}
    \specline{\exsts{\V{n}}\boxass{\vx \pt \V{n}}{\lrid}{\intass} \land \V{n} \geq 0 \sep \cass{\C{Rd}}{\lrid} } \\
    \begin{transaction}
        \specline{ \exsts{ \V{v} } \vx \pt \V{v} { \color{gray} \land \V{v} = \V{n} } } \\
        \pderef{\pvar{c}}{\vx} ; \\
        \specline{ \exsts{ \V{v} } \vx \pt \V{v} \sep \Set{(\etR, \vx, \V{v})} { \color{gray} \land \V{v} = \V{n} } } \\
    \end{transaction} \\
    \specline{\exsts{\V{n}}\boxass{\vx \pt \V{n}}{\lrid}{\intass} \land \V{n} \geq 0 \sep \cass{\C{Rd}}{\lrid} } \\
    \end{session}
\end{parl} \\
\specline{\boxass{\vx \pt 2}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} \sep \cass{\C{Rd}}{\lrid} \sep \cass{\C{Rd}}{\lrid} } \\
\specline{\boxass{\vx \pt 2}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} } \\
\end{session}
\]
\subsubsection{SI/PSI}
\[
    \begin{array}{@{}l@{}}
        \intass : 
        \begin{rclarray}[t]
        \C{Inc} & : & \exsts{\V{m, k}} \Set{(\etR, \V{x}, \V{m}), (\etW, \V{x}, \V{m} + 1)} \mat \V{x} \pt \V{k} \oassto \V{x} \pt \V{k} \\
        \C{Rd}  & : & \exsts{\V{m, k, v}} \Set{(\etR, \V{x}, \V{m})} \mat \V{x} \pt \V{k} \oassto \V{x} \pt \V{v} \land \V{v} \leq \V{k} \\ 
        \end{rclarray} \\
        \C{Inc} \composeK \C{Inc} \text{ is undefined} \\
        \C{Rd} \text{ is the unit element} \\
    \end{array}
\]

\[
\begin{session}
\specline{\boxass{\vx \pt 0}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} } \\
\specline{\boxass{\vx \pt 0}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} \sep \cass{\C{Rd}}{\lrid} \sep \cass{\C{Rd}}{\lrid} } \\
\begin{parl}
    \begin{session}
    \specline{\boxass{\vx \pt 0}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} \sep \cass{\C{Rd}}{\lrid} } \\
    \begin{transaction}
        \specline{ \vx \pt 0 } \\
        \pderef{\pvar{a}}{\vx} ; \\
        \specline{ \vx \pt 0 \land \pvar{a} = 0 \sep \Set{(\etR, \vx, 0)} } \\
        \pmutate{\vx}{\pvar{a} + 1} ; \\
        \specline{ \vx \pt 1 \land \pvar{a} = 0 \\
                {} \sep \Set{(\etR, \vx, 0), (\etW, \vx, 1)} } \\
    \end{transaction} \\
    \specline{\boxass{\vx \pt 1}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} \sep \cass{\C{Rd}}{\lrid} } \\
    \begin{transaction}
        \specline{ {\color{purple} \vx \pt 0} \lor \vx \pt 1 } \\
        \pderef{\pvar{b}}{\vx} ; \\
        \specline{ { \color{purple} \vx \pt 0 \sep \Set{(\etR, \vx, 0)} }  \\
                    {} \lor \vx \pt 1 \sep \Set{(\etR, \vx, 1)} } \\
    \end{transaction} \\
    \specline{\boxass{\vx \pt 1}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} \sep \cass{\C{Rd}}{\lrid} } \\
    \begin{transaction}
        \specline{ \vx \pt 1 } \\
        \pderef{\pvar{a}}{\vx} ; \\
        \specline{ \vx \pt 1 \land \pvar{a} = 1 \sep \Set{(\etR, \vx, 1)} } \\
        \pmutate{\vx}{\pvar{a} + 1} ; \\
        \specline{ \vx \pt 2 \land \pvar{a} = 1 \\
                {} \sep \Set{(\etR, \vx, 1), (\etW, \vx, 2)} } \\
    \end{transaction} \\
    \specline{\boxass{\vx \pt 2}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} \sep \cass{\C{Rd}}{\lrid} } \\
    \end{session}
    &
    \begin{session}
    \specline{\exsts{\V{n}}\boxass{\vx \pt \V{n}}{\lrid}{\intass} \land \V{n} \geq 0 \sep \cass{\C{Rd}}{\lrid} } \\
    \begin{transaction}
        \specline{ \exsts{ \V{v} } \vx \pt \V{v} { \color{gray} \land \V{v} \leq \V{n} } } \\
        \pderef{\pvar{c}}{\vx} ; \\
        \specline{ \exsts{ \V{v} } \vx \pt \V{v} \sep \Set{(\etR, \vx, \V{v})} { \color{gray} \land \V{v} \leq \V{n} } } \\
    \end{transaction} \\
    \specline{\exsts{\V{n}}\boxass{\vx \pt \V{n}}{\lrid}{\intass} \land \V{n} \geq 0 \sep \cass{\C{Rd}}{\lrid} } \\
    \end{session}
\end{parl} \\
\specline{\boxass{\vx \pt 1}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} \sep \cass{\C{Rd}}{\lrid} \sep \cass{\C{Rd}}{\lrid} } \\
\specline{\boxass{\vx \pt 1}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} } \\
\end{session}
\]

\subsubsection{Causal}

\[
    \begin{array}{@{}l@{}}
        \intass : 
        \begin{rclarray}[t]
        \C{Inc} & : & \exsts{\V{m, k}} \Set{(\etR, \V{x}, \V{m}), (\etW, \V{x}, \V{m} + 1)} \mat \V{x} \pt \V{k} \oassto \V{x} \pt \V{v} \\
        \C{Rd}  & : & \exsts{\V{m, k, v}} \Set{(\etR, \V{x}, \V{m})} \mat \V{x} \pt \V{k} \oassto \V{x} \pt \V{v} \\ 
        \end{rclarray} \\
        \C{Inc} \composeK \C{Inc} \text{ is undefined} \\
        \C{Rd} \text{ is the unit element} \\
    \end{array}
\]

\[
\begin{session}
\specline{\boxass{\vx \pt 0}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} } \\
\specline{\boxass{\vx \pt 0}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} \sep \cass{\C{Rd}}{\lrid} \sep \cass{\C{Rd}}{\lrid} } \\
\begin{parl}
    \begin{session}
    \specline{\boxass{\vx \pt 0}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} \sep \cass{\C{Rd}}{\lrid} } \\
    \begin{transaction}
        \specline{ \exsts{ \V{v} } \vx \pt \V{v} } \\
        \pderef{\pvar{a}}{\vx} ; \\
        \specline{ \exsts{ \V{v} } \vx \pt \V{v} \land \pvar{a} = \V{v} \sep \Set{(\etR, \vx, \V{v})} } \\
        \pmutate{\vx}{\pvar{a} + 1} ; \\
        \specline{ \vx \pt \V{v} + 1 \land \pvar{a} = \V{v} \\
                {} \sep \Set{(\etR, \vx, \V{v}), (\etW, \vx, \V{v} + 1)} } \\
    \end{transaction} \\
    \specline{\exsts{\V{n}}\boxass{\vx \pt \V{n}}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} \sep \cass{\C{Rd}}{\lrid} } \\
    \begin{transaction}
        \specline{ \exsts{ \V{v} } \vx \pt \V{v} } \\
        \pderef{\pvar{c}}{\vx} ; \\
        \specline{ \exsts{ \V{v} } \vx \pt \V{v} \sep \Set{(\etR, \vx, \V{v})} } \\
    \end{transaction} \\
    \specline{\exsts{\V{n}}\boxass{\vx \pt \V{n}}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} \sep \cass{\C{Rd}}{\lrid} } \\
    \begin{transaction}
        \specline{ \exsts{ \V{v} } \vx \pt \V{v} } \\
        \pderef{\pvar{a}}{\vx} ; \\
        \specline{ \exsts{ \V{v} } \vx \pt \V{v} \land \pvar{a} = \V{v} \sep \Set{(\etR, \vx, \V{v})} } \\
        \pmutate{\vx}{\pvar{a} + 1} ; \\
        \specline{ \vx \pt \V{v} + 1 \land \pvar{a} = \V{v} \\
                {} \sep \Set{(\etR, \vx, \V{v}), (\etW, \vx, \V{v} + 1)} } \\
    \end{transaction} \\
    \specline{\exsts{\V{n}}\boxass{\vx \pt \V{n}}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} \sep \cass{\C{Rd}}{\lrid} } \\
    \end{session}
    &
    \begin{session}
    \specline{\exsts{\V{n}}\boxass{\vx \pt \V{n}}{\lrid}{\intass} \sep \cass{\C{Rd}}{\lrid} } \\
    \begin{transaction}
        \specline{ \exsts{ \V{v} } \vx \pt \V{v} { \color{gray} \land \V{v}, \V{n} } } \\
        \pderef{\pvar{c}}{\vx} ; \\
        \specline{ \exsts{ \V{v} } \vx \pt \V{v} \sep \Set{(\etR, \vx, \V{v})} { \color{gray} \land \V{v}, \V{n} } } \\
    \end{transaction} \\
    \specline{\exsts{\V{n}}\boxass{\vx \pt \V{n}}{\lrid}{\intass} \sep \cass{\C{Rd}}{\lrid} } \\
    \end{session}
\end{parl} \\
\specline{\exsts{\V{n}}\boxass{\vx \pt \V{n}}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} \sep \cass{\C{Rd}}{\lrid} \sep \cass{\C{Rd}}{\lrid} } \\
\specline{\exsts{\V{n}}\boxass{\vx \pt \V{n}}{\lrid}{\intass} \sep \cass{\C{Inc}}{\lrid} } \\
\end{session}
\]

\subsection{Two associated bank accounts}
\[
    \begin{array}{@{}l@{}}
        \boxass{\V{x} \pt \V{n} \sep \V{y} \pt \V{m} }{\lrid}{\intass} \\
        \C{xx} \composeK \C{xx} \text{ is undefined} \\
        \C{yy} \composeK \C{yy} \text{ is undefined} \\
        \C{Rd} \text{ is the unit} \\
    \end{array}          
\]

\subsubsection{SER}
\[
    \begin{array}{@{}l@{}}
        \intass : 
        \begin{rclarray}[t]
        \C{xx} & : & \exsts{\V{v, k, a, b }} \Setcon{(\etR, \V{x}, \V{v}), (\etR, \V{y}, \V{k}), (\etW, \V{x}, \V{v} - 100)}{\V{v} + \V{k} \geq 100} \\
        & & \qqquad \mat \V{x} \pt \V{a} \sep \V{y} \pt \V{b} \oassto \V{x} \pt \V{a} \sep \V{y} \pt \V{b} \land \V{a} + \V{b} \geq 0 \\
        \C{yy} & : & \exsts{\V{v, k, a, b }} \Setcon{(\etR, \V{x}, \V{v}), (\etR, \V{y}, \V{k}), (\etW, \V{y}, \V{k} - 100)}{\V{v} + \V{k} \geq 100} \\
        & & \qqquad \mat \V{x} \pt \V{a} \sep \V{y} \pt \V{b} \oassto \V{x} \pt \V{a} \sep \V{y} \pt \V{b} \land \V{a} + \V{b} \geq 0 \\
        \C{Rd} & : & \exsts{\V{v, k, a, b }} \Set{(\etR, \V{x}, \V{v}), (\etR, \V{y}, \V{k})} \\
        & & \qqquad \mat \V{x} \pt \V{a} \sep \V{y} \pt \V{b} \oassto \V{x} \pt \V{a} \sep \V{y} \pt \V{b} \land \V{a} + \V{b} \geq 0 \\
        \end{rclarray} \\
    \end{array}
\]

\[
\begin{session}
\specline{ \boxass{ \vx \pt 60 \sep \vy \pt 60 }{\lrid}{\intass} \sep \cass{\C{xx}}{\lrid} \sep \cass{\C{yy}}{\lrid} } \\
\begin{parl}
    \begin{session}
        \specline{ \boxass{ \vx \pt 60 \sep \vy \pt 60 \lor \vx \pt 60 \sep \vy \pt -40 }{\lrid}{\intass} \sep \cass{\C{xx}}{\lrid} } \\
        \begin{transaction}
            \specline{\vx \pt 60 \sep \vy \pt 60 \\ {} \lor \vx \pt 60 \sep \vy \pt -40} \\
            \pderef{\pvar{a}}{\vx}; \\
            \pderef{\pvar{b}}{\vy}; \\
            \pifs{\pvar{a} + \pvar{b} \geq 100} \\
            \quad \pmutate{\vx}{\pvar{a} - 100} ; \\
            \pife \\
            \specline{\vx \pt-40 \sep \vy \pt 60 \sep {} \\
            \Set{(\etR, \vx, 60), (\etR, \vy, 60), (\etW, \vx, -40)} \\ 
            {} \lor \vx \pt 60 \sep \vy \pt -40 \sep {} \\
            \Set{(\etR, \vx, 60), (\etR, \vy, -40)} }
        \end{transaction} \\
        \specline{ \boxass{ \vx \pt -40 \sep \vy \pt 60 \lor \vx \pt 60 \sep \vy \pt -40 }{\lrid}{\intass} \sep \cass{\C{xx}}{\lrid} } \\
    \end{session}
    &
    \begin{session}
        \specline{ \boxass{ \vx \pt -40 \sep \vy \pt 60 \lor \vx \pt 60 \sep \vy \pt 60 }{\lrid}{\intass} \sep \cass{\C{yy}}{\lrid} } \\
        \begin{transaction}
            \pderef{\pvar{a}}{\vx}; \\
            \pderef{\pvar{b}}{\vy}; \\
            \pifs{\pvar{a} + \pvar{b} \geq 100} \\
            \quad \pmutate{\vy}{\pvar{b} - 100} ; \\
            \pife 
        \end{transaction} \\
        \specline{ \boxass{ \vx \pt -40 \sep \vy \pt 60 \lor \vx \pt 60 \sep \vy \pt -40 }{\lrid}{\intass} \sep \cass{\C{yy}}{\lrid} } \\
    \end{session}
\end{parl} \\
\specline{ \boxass{ \vx \pt -40 \sep \vy \pt 60 \lor \vx \pt 60 \sep \vy \pt -40 }{\lrid}{\intass} \sep \cass{\C{xx}}{\lrid} \sep \cass{\C{yy}}{\lrid} } \\
\end{session}
\]

\subsubsection{SI/PSI}
\[
    \begin{array}{@{}l@{}}
        \intass : 
        \begin{rclarray}[t]
        \C{xx} & : & \exsts{\V{v, k, a, b, c }} \Setcon{(\etR, \V{x}, \V{v}), (\etR, \V{y}, \V{k}), (\etW, \V{x}, \V{v} - 100)}{\V{v} + \V{k} \geq 100} \\
        & & \qqquad \mat \V{x} \pt \V{a} \sep \V{y} \pt \V{b} \oassto \V{x} \pt \V{a} \sep \V{y} \pt \V{b} + ( \V{c} \times 100 ) \\
        \C{yy} & : & \exsts{\V{v, k, a, b, c }} \Setcon{(\etR, \V{x}, \V{v}), (\etR, \V{y}, \V{k}), (\etW, \V{y}, \V{k} - 100)}{\V{v} + \V{k} \geq 100} \\
        & & \qqquad \mat \V{x} \pt \V{a} \sep \V{y} \pt \V{b} \oassto \V{x} \pt \V{a} + ( \V{c} \times 100 ) \sep \V{y} \pt \V{b} \\
        \C{Rd} & : & \exsts{\V{v, k, a, b, c, d }} \Set{(\etR, \V{x}, \V{v}), (\etR, \V{y}, \V{k})} \\
        & & \qqquad \mat \V{x} \pt \V{a} \sep \V{y} \pt \V{b} \oassto \V{x} \pt \V{a} + ( \V{c} \times 100 ) \sep \V{y} \pt \V{b} + ( \V{d} \times 100 ) \\
        \end{rclarray} \\
    \end{array}
\]

\[
\begin{session}
\specline{ \boxass{\vx \pt 60 \sep \vy \pt 60 }{\lrid}{\intass} \sep \cass{\C{xx}}{\lrid} \sep \cass{\C{yy}}{\lrid} } \\
\begin{parl}
    \begin{session}
        \specline{ \exsts{ \V{n} } \boxass{\vx \pt 60 \sep \vy \pt 60 - \V{n} \times 100 }{\lrid}{\intass} \sep \cass{\C{xx}}{\lrid} } \\
        \begin{transaction}
            \specline{ \exsts{ \V{n}, \V{k} \geq 0 } \vx \pt 60 + \V{k} \times 100 \sep \vy \pt 60 + \V{n} \times 100 } \\
            \pderef{\pvar{a}}{\vx}; \\
            \pderef{\pvar{b}}{\vy}; \\
            \specline{ \exsts{ \V{n}, \V{k} \geq 0 } \vx \pt 60 + \V{k} \times 100 \sep \vy \pt 60 + \V{n} \times 100 \\
                        {} \sep \Set{ (\etR, \vx, 60 + \V{k} \times 100), (\etR, \vx, 60 + \V{n} \times 100) } \\
                        {} \land \pvar{a} = 60 + \V{k} \times 100 \land \pvar{b} = 60 + \V{n} \times 100 } \\
            \pifs{\pvar{a} + \pvar{b} \geq 100} \\
            \quad \specline{ \exsts{ \V{n}, \V{k} \geq 0 } \vx \pt 60 + \V{k} \times 100 \sep \vy \pt 60 + \V{n} \times 100 \\
                            {} \sep \Set{ (\etR, \vx, 60 + \V{k} \times 100), (\etR, \vx, 60 + \V{n} \times 100) } \\
                            {} \land \pvar{a} = 60 + \V{k} \times 100 \land \pvar{b} = 60 + \V{n} \times 100 \land \V{k} + \V{N} \geq 0} \\
            \quad \pmutate{\vx}{\pvar{a} - 100} ; \\
            \quad \specline{ \exsts{ \V{n}, \V{k} \geq 0 } \vx \pt -40 + \V{k} \times 100 \sep \vy \pt 60 + \V{n} \times 100 \\
                            {} \sep \Set{ (\etR, \vx, 60 + \V{k} \times 100), (\etR, \vx, 60 + \V{n} \times 100), \\ 
                                                    (\etW, \vx, -40 + \V{k} \times 100) } \\
                            {} \land \pvar{a} = 60 + \V{k} \times 100 \land \pvar{b} = 60 + \V{n} \times 100 \land \V{k} + \V{N} \geq 0} \\
            \pife \\
            \comment{Weaken the assertion by } \\
            \comment{throwing away program variables.} \\
            \specline{ \exsts{ \V{n}, \V{k} \geq 0 } \vy \pt 60 + \V{n} \times 100 \\
                        {} \sep 
                        \begin{formulea}
                        \vx \pt -40 + \V{k} \times 100 
                        \land \V{k} + \V{N} \geq 0 \\
                        {} \sep \Set{ (\etR, \vx, 60 + \V{k} \times 100), (\etR, \vx, 60 + \V{n} \times 100), \\
                                                (\etW, \vx, -40 + \V{k} \times 100) } \\
                        \end{formulea} \\
                        {} \lor 
                        \begin{formulea}
                        \vx \pt 60 + \V{k} \times 100 \\ 
                        {} \sep \Set{ (\etR, \vx, 60 + \V{k} \times 100), (\etR, \vx, 60 + \V{n} \times 100) } 
                        \end{formulea}
                    } \\
        \end{transaction} \\
        \comment{To allow the write to be committed,} \\
        \comment{the \V{K} must be 0 } \\
        \specline{ \exsts{ \V{n} } \boxass{ ( \vx \pt 60 \lor \vx \pt -40 ) \sep \vy \pt 60 - \V{n} \times 100 }{\lrid}{\intass} \sep \cass{\C{xx}}{\lrid} } \\
    \end{session}
    &
    \begin{session}
        \specline{ \exsts{ \V{n} } \boxass{\vx \pt 60 - \V{n} \times 100 \sep \vy \pt 60 }{\lrid}{\intass} \sep \cass{\C{yy}}{\lrid} } \\
        \begin{transaction}
            \pderef{\pvar{a}}{\vx}; \\
            \pderef{\pvar{b}}{\vy}; \\
            \pifs{\pvar{a} + \pvar{b} \geq 100} \\
            \quad \pmutate{\vy}{\pvar{b} - 100} ; \\
            \pife 
        \end{transaction} \\
        \specline{ \exsts{ \V{n} } \boxass{\vx \pt 60 - \V{n} \times 100 \sep ( \vy \pt 60 \lor \vy \pt -40 ) }{\lrid}{\intass} \sep \cass{\C{yy}}{\lrid} } \\
    \end{session}
\end{parl} \\
\specline{ \boxass{\vx \pt -40 \sep \vy \pt 60 \lor \vx \pt 60 \sep \vy \pt -40 \lor \vx \pt -40 \sep \vy \pt -40 }{\lrid}{\intass} \sep \cass{\C{xx}}{\lrid} \sep \cass{\C{yy}}{\lrid} } \\
\end{session}
\]


\subsection{Litmus Test For SI}
\[
    \boxass{ \V{x} \pt \V{n} \sep \V{y} \pt \V{m} }{\lrid}{\intass} 
\]
\[
\intass :
\begin{rclarray}[t]
    \C{L} & : & \exsts{ \V{k}, \V{v}, \V{z} } \Set{(\etR, \V{x}, 0), (\etW, \V{y}, 1)} \mat \V{x} \pt \V{k} \sep \V{y} \pt \V{v} \oassto  \V{x} \pt \V{z} \sep \V{y} \pt \V{v} \land (\V{k} = 1 \land \V{z} \in \Set{0,1}) \lor \V{k} = \V{z}  \\
    \C{R} & : & \exsts{ \V{k}, \V{v}, \V{z} } \Set{(\etR, \V{y}, 0), (\etW, \V{x}, 1)} \mat \V{x} \pt \V{k} \sep \V{y} \pt \V{v} \oassto  \V{x} \pt \V{k} \sep \V{y} \pt \V{z} \land (\V{v} = 1 \land \V{z} \in \Set{0,1}) \lor \V{v} = \V{z}  \\
    \C{Rd} & : & \exsts{ \V{a} \in \Set{ \V{x}, \V{y} }, \V{v}, \V{k}, \V{z} } \Set{(\etR, \V{a}, \V{v})} \mat \V{a} \pt \V{k} \oassto  \V{a} \pt \V{z} \land (\V{k} = 1 \land \V{z} \in \Set{0,1}) \lor \V{k} = \V{z}  \\
\end{rclarray}
\]

%A dummy bank transfer example that is not serialisable.
%\[
    %\begin{rclarray}
        %\intass(\rid) & = &
        %\begin{cases}
            %\unitelem{} : \exsts{x, m, k} x \fpt{\fp} n \sep \cass{S(m)}{\rid} \transfersto x \fpt{\addFPW{\fp}} n \pm k \sep  \cass{S(m \pm k)}{\rid} \\
            %\unitelem{} : \exsts{x} x \fpt{\fp} n \transfersto x \fpt{\addFPR{\fp}} n 
        %\end{cases} \\
        %S(m) \composeK S(n) & = & S(m+n) \\
        %S(0) & \in & \unitK \\
    %\end{rclarray}
%\]
%A dummy bank transfer example that is serialisable even under snapshot isolation.
%\[
    %\begin{rclarray}
        %\intass & = &
        %\begin{cases}
            %\unitelem{} : \exsts{x, y, m, k} x \fpt{\fp} n \sep  y \fpt{\fp'} m \transfersto x \fpt{\addFPW{\fp}} n - k \sep \fpt{\addFPW{\fp}} m + k  \\
            %\unitelem{} : \exsts{x} x \fptEMP n \transfersto x \fptR n 
        %\end{cases}
    %\end{rclarray}
%\]
%If x write y and if y write x example.
%\[
    %\begin{rclarray}
        %\intass(x,y) & = &
        %\begin{cases}
            %\perm{L} : x \fptEMP 0 \sep y \fptEMP 0 \transfersto x \fptW 1 \sep y \fptR 0 \\
            %\perm{R} : x \fptEMP 0 \sep y \fptEMP 0 \transfersto x \fptR 0 \sep y \fptW 1 \\
        %\end{cases}
    %\end{rclarray}
%\]
