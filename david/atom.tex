\section{Atom Proof}

\[
\begin{array}{r l}
\pred{atom}{\mathds{P}} \triangleq&
\begin{array}{l}
\forall h, h', S, S', \Phi \ldotp \\
(h, \Phi, S, \mathds{P}) \rightarrow^* (h', \emptyset, S', \pskip) \implies 
(h, \mathds{P}) \tred^* (h', \pskip)
\end{array}
\end{array}
\]

\subsection{Lemmas}

\lem
\[
\begin{array}{r l}
	\pred{aseq}{\mathds{P}_1} \triangleq
	&
	\begin{array}{l}
	\forall h, h', \mathds{P}_2 \ldotp \\
	(h, \mathds{P}_1) \tred^* (h', \pskip) \Rightarrow 
	(h, \mathds{P}_1; \mathds{P}_2) \tred^* (h', \pskip; \mathds{P}_2)
	\end{array}
\end{array}
\]

{\parindent0pt
\begin{proof}
$\forall \mathds{P}_1 \ldotp \pred{aseq}{\mathds{P}_1}$ by induction on $n$, i.e. the number of reduction steps in $\tred^*$. \\

\textit{Base case}: $n = 0$

\textit{To show}: 
\[
\begin{array}{l}
\forall h, h', \mathds{P}_2 \ldotp \\
(h, \mathds{P}_1) \tred^0 (h', \pskip) \implies 
(h, \mathds{P}_1; \mathds{P}_2) \tred^* (h', \pskip; \mathds{P}_2)
\end{array}
\]
We assume $(h, \mathds{P}_1) \tred^0 (h', \pskip)$ holds and given it is a zero-step reduction, the only possible case is for $\mathds{P}_1 = \pskip$. Therefore $(h, \pskip) \tred^0 (h', \pskip)$ where $h = h'$. Now for $m = 0$ we have $(h, \pskip; \mathds{P}_2) \tred^0 (h', \pskip; \mathds{P}_2)$ given that $\tred^*$ is a reflexive relation, again for $h = h'$. \\

\textit{Inductive case}: For some arbitrary $n > 0$

\textit{Inductive hypothesys}: Assume the property holds for some arbitrary program $\mathds{P}_1'$ and $n$ steps, and such that $(h, \mathds{P}_1) \tred (h'', \mathds{P}_1')$.
\[
\begin{array}{l}
\forall h, h', \mathds{P}_2 \ldotp \\
(h, \mathds{P}_1') \tred^n (h', \pskip) \implies 
(h, \mathds{P}_1'; \mathds{P}_2) \tred^* (h', \pskip; \mathds{P}_2)
\end{array}
\]
\textit{To show}:
\[
\begin{array}{l}
\forall h, h', \mathds{P}_2 \ldotp \\
(h, \mathds{P}_1) \tred^{n+1} (h', \pskip) \implies 
(h, \mathds{P}_1; \mathds{P}_2) \tred^* (h', \pskip; \mathds{P}_2)
\end{array}
\]
We assume $(h, \mathds{P}_1) \tred^{n+1} (h', \pskip)$ holds and we also know that $(h, \mathds{P}_1) \tred (h'', \mathds{P}_1')$. The latter is the premiss of rule \textsc{PSeq} for the conclusion $(h, \mathds{P}_1; \mathds{P}_2) \tred (h'', \mathds{P}_1'; \mathds{P}_2)$ in one step of reduction. Therefore by this fact and the inductive hypothesys we obtain that $\pred{aseq}{\mathds{P}_1}$ holds for $n + 1$ steps.

\end{proof}
}

\lem
\[
\begin{array}{r l}
	\pred{2seq}{\mathds{P}_1} \triangleq
	&
	\begin{array}{l}
	\forall h, h', S, S', \Phi, \mathds{P}_2 \ldotp \\ 
	(h, \Phi, S, \mathds{P}_1; \mathds{P}_2) \rightarrow^* (h', \emptyset, S', \pskip; \mathds{P}_2)
	\Rightarrow
	(h, \Phi, S, \mathds{P}_1) \rightarrow^* (h', \emptyset, S', \pskip)
	\end{array}
\end{array}
\]

{\parindent0pt
\begin{proof}
$\forall \mathds{P}_1 \ldotp \pred{2seq}{\mathds{P}_1}$ by induction on $n$, i.e. the number of reduction steps in $\rightarrow^*$. \\

\textit{Base case}: $n = 0$

\textit{To show}:
\[
\begin{array}{l}
\forall h, h', S, S', \Phi, \mathds{P}_2 \ldotp \\ 
	(h, \Phi, S, \mathds{P}_1; \mathds{P}_2) \rightarrow^0 (h', \emptyset, S', \pskip; \mathds{P}_2)
	\Rightarrow
	(h, \Phi, S, \mathds{P}_1) \rightarrow^* (h', \emptyset, S', \pskip)
\end{array}
\]
We assume that $(h, \Phi, S, \mathds{P}_1; \mathds{P}_2) \rightarrow^0 (h', \emptyset, S', \pskip; \mathds{P}_2)$ holds. A zero-step reduction means that it must be the case that $\mathds{P}_1 = \pskip$. Therefore $(h, \Phi, S, \pskip; \mathds{P}_2) \rightarrow^0 (h', \emptyset, S', \pskip; \mathds{P}_2)$ for $h = h', \Phi = \emptyset, S = S'$. \\

\textit{Inductive case}: For some arbitrary $n > 0$

\textit{Inductive hypothesys}: Assume the property holds for some arbitrary program $\mathds{P}_1'; \mathds{P}_2$ and $n$ steps, and such that $(h, \Phi, S, \mathds{P}_1; \mathds{P}_2) \tred (h'', \Phi'', S'', \mathds{P}_1'; \mathds{P}_2)$.
\[
\begin{array}{l}
\forall h, h', S, S', \Phi, \mathds{P}_2 \ldotp \\ 
	(h, \Phi, S, \mathds{P}_1'; \mathds{P}_2) \rightarrow^n (h', \emptyset, S', \pskip; \mathds{P}_2)
	\Rightarrow
	(h, \Phi, S, \mathds{P}_1') \rightarrow^* (h', \emptyset, S', \pskip)
\end{array}
\]

\textit{To show}:
\[
\begin{array}{l}
\forall h, h', S, S', \Phi, \mathds{P}_2 \ldotp \\ 
	(h, \Phi, S, \mathds{P}_1; \mathds{P}_2) \rightarrow^{n+1} (h', \emptyset, S', \pskip; \mathds{P}_2)
	\Rightarrow
	(h, \Phi, S, \mathds{P}_1) \rightarrow^* (h', \emptyset, S', \pskip)
\end{array}
\]

We assume that $(h, \Phi, S, \mathds{P}_1; \mathds{P}_2) \rightarrow^{n+1} (h', \emptyset, S', \pskip; \mathds{P}_2)$ holds and we also know that in one step of reduction we get $(h, \Phi, S, \mathds{P}_1; \mathds{P}_2) \tred (h'', \Phi'', S'', \mathds{P}_1'; \mathds{P}_2)$. The latter is the conclusion of rule \textsc{PSeq}, so we know that if it happened then it must be the case that $(h, \Phi, S, \mathds{P}_1) \rightarrow (h'', \Phi'', S'', \mathds{P}_1')$ holds in the premiss. Now, by inductive hypothesys we can conclude that the property holds for $n + 1$ steps.

\end{proof}
}

\lem
\[
\forall h, h', S, S', \Phi, \Phi', \mathds{P} \ldotp
(h, \Phi, S, \mathds{P}) \rightarrow^* (h', \Phi', S', \pskip) \implies \Phi' \equiv \emptyset
\]
