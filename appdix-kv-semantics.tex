\section{Operational Semantics on KV-Stores}
\label{sec:full-semantics}

\begin{definition}[Multi-version Key-value Stores]
\label{def:mkvs-appendix}
Assume a countably infinite set of \emph{keys} $\Keys \ni \key$, 
and a countably infinite set of  \emph{values} $\Val \ni \val$, 
including an \emph{initialisation value} $\val_0 $.
The set of \emph{versions}, $\Versions \ni \ver$, is: $\Versions \defeq \Val \times \TxID \times \pset{\TxID_{0}}$. 
A \emph{kv-store} is a function $\mkvs: \Keys \to \func{List}[\Versions]$, 
where $\func{List}[\Versions] \ni \vilist$ is the set of lists of versions $\Versions$. 
Well-formed key-values store satisfy:
\begin{align}
& \fora{\key, i, j} 
\rsOf(\mkvs(\key, i)) \cap \rsOf(\mkvs(\key, j)) \neq \emptyset \lor
\wtOf(\mkvs(\key, i)) = \wtOf(\mkvs(\key, j))
\implies i = j  \\
& \fora{\key} \mkvs(\key, 0) = (\val_0, \txid_0, \stub) \\
& \fora{ \key, \cl, i,j, n, m} 
\txid_{\cl}^{n} = \wtOf(\mkvs(\key,i)) \land \txid_{\cl}^{m} \in
\Set{\wtOf(\mkvs(\key,j))} \cup \rsOf(\mkvs(\key, i)) \implies n < m
\end{align}
\end{definition}
\ac{Well formed key-value stores have already been introduced in the main text. 
You should say that you are giving the formal definition of a notion that has alredy been 
introduced. Also, the formal definition of well-formed kv-stores should be in a definition environment.}
The full operational semantics is given in \cref{fig:full-semantics}.
\ac{Split the rules into several tables. One for transactions, one for clients. 
Each of the rules should be discussed, if they are standard you should say so.}
\input{\RootPath/semantics/semantics-fig.tex}
% composition of kv

%\newpage
%\input{\RootPath/composition-et/updatekv-well-defined.tex}
