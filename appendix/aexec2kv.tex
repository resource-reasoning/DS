\section{Proof of Theorem \ref{thm:aexec2kv.compatible}}
\label{app:aexec2kv}

Let $\aexec$ be an abstract execution that satisfies the last write wins 
policy.

%\begin{lemma}
%$\getView(\aexec, \emptyset) = \lambda \ke.\{0\}$.
%\end{lemma}
%
%\begin{proof}
%$\getView(\aexec, \emptyset)(\ke) = \{0\} \cup \{ i \mid 
%\WTx(\hh(\ke, i)) \in \emptyset\} = \{0\} \cup \emptyset = \{0\}$.
%\end{proof}
%%
%%\begin{lemma}
%%Let $\txid$ be a read-only transaction in $\aexec$, that is whenever $(O, \_, \_) \in_{\aexec} \txid$, 
%%then $O = \otR$. Then $\getView(\aexec, \{\txid\}) = \lambda \ke. \{0\}$.
%%\end{lemma}
%%
%\begin{lemma}
%$\getView(\aexec, \{\txid\}) = \lambda \ke. \{0\} \cup \{i \mid 
%\WTx(\hh(\ke, i) = \txid\}$
%\end{lemma}
%
%\begin{proof}
%Immediate from the definition of $\getView$.
%\end{proof}
%
%\begin{lemma}
%For any $\T_1, \T_2 \subseteq \T_{\aexec}$, $\getView(\aexec, \T_1 \cup \T_2) = 
%\getView(\aexec, \T_1) \cup \getView(\aexec, \T_2)$.
%\end{lemma}
%
%\begin{proof}
%\[
%\begin{array}{lr}
%\getView(\aexec, \T_1 \cup \T_2)(\ke) = \{ 0 \} \cup \{ i \mid \WTx(\hh(\ke, i)) \in \T_1 \cup \T_2\} &=\\
%\{0\} \cup (\{i \mid \WTx(\hh(\ke, i)) \in \T_1\} \cup \{i \mid \WTx(\hh(\ke, i)) \in \T_2\}) &= \\
%(\{0\} \cup \{i \mid \WTx(\hh(\ke,i)) \in \T_1\}) \cup \{i \mid \WTx(\hh(\ke, i)) \in \T_2\}) &= \\
%\getView(\aexec, \T_1) \cup \getView(\aexec, \T_2).
%\end{array}
%\]
%\end{proof}
%
%\begin{lemma}
%Let $\txid_1, \txid_2 \in \T_{\aexec}$. If $\getView(\aexec, \{\txid_1\})(\ke) \cap \getView(\aexec, \{\txid_2\})(\ke) \neq \emptyset$ 
%for some $\ke \in \Keys$, then $\txid_1 = \txid_2$.
%\end{lemma}
%
%\begin{proof}
%Fix $\ke \in \Keys$, and suppose that $i \in \getView(\aexec, \{\txid_1\})(\ke) \cap \getView(\aexec, \{\txid_2\})(\ke)$. 
%By definition, $\txid_1 = \WTx(\hh_{\aexec}(\ke, i)) = \txid_2$. 
%\end{proof}

\begin{proposition}
\label{prop:compatible.aexec2kv}
For any subset $\T \subseteq \T_{\aexec}$, $\RP_{\LWW}(\aexec, \T) = \{\snapshot(\hh_{\aexec}, \getView(\aexec, \T))\}$.
\end{proposition}

\begin{proof}
Fix $\T \subseteq \aexec$, and let $\{\hh\} = \RP_{\LWW}(\aexec, \T)$. We prove that, for any $\ke \in \Keys$, 
$\hh(\ke) = \snapshot(\getView(\aexec, \T))(\ke)$. We distinguish between two different cases: 
\begin{enumerate}
\item $\T \cap \{ \txid \mid (\otW, \ke, \_) \in_{\aexec} \txid \} = \emptyset$. 
In this case $\hh(\ke) = \val_0$. 
We know that $\graphof(\aexec)$ satisfies all the constraints required by the definition of dependency graph 
(\cite{laws}). Together with \ref{thm:kv2graphs} it follows that $\hh_{\aexec}(\ke, 0) = (\val_0, \txid_0, \_)$.
We prove that $\getView(\aexec, \T)(\ke) = \{0\}$, 
hence 
\[ 
\snapshot(\hh_{\aexec}, \getView(\aexec, \T))(\ke) = \valueOf(\hh_{\aexec}(\ke, 0)) = \val_{0}.
\]
Note that whenever $(\otW, \ke, \_) \in_{\aexec} \txid$ for some $\txid$, then 
$\txid \notin \T$. Therefore, whenever $(\val, \txid, \_) = \hh_{\aexec}(\ke, i)$ for some $i \geq 0$, then 
$\txid \notin \T_{\graphof(\aexec)} = \T_{\aexec}$.
\[
\getView(\aexec, \T)(\ke) = \{0\} \cup \{i \mid \WTx(\hh_{\aexec}(\ke, i)) \in \T)\} = \{0\} \cup \emptyset = \{0\}.
\]
\item Suppose now that $\T \cap \{ \txid \mid (\otW, \ke, \_) \in_{\aexec} \txid \} \neq \emptyset$. 
Let then $\txid = \max_{\AR_{\aexec}}(\T \cap \{\txid \mid (\otW, \ke, \_) \in_{\aexec} \txid\})$. 
Then $(\otW, \ke, \val) \in_{\aexec} \txid$ for some $\val \in \Val$. Furthermore, $\RP_{\LWW}(\aexec, \T)(\ke) = \val$.
By definition, $\txid' \in \T \cap \{ \txid \mid (\otW, \ke, \_) \in_{\aexec} \txid\}$, 
then either $\txid' = \txid$ or $\txid' \xrightarrow{\AR_{\aexec}} \txid$. The definition of 
$\graphof(\aexec)$ gives that $\txid' \xrightarrow{\VO_{\aexec}(\ke)} \txid$. 
Because $(\otW, \ke, \val) \in_{\aexec} \txid$, then there exists an index 
$i \geq 0$ such that $\hh_{\aexec}(\ke, i) = (\val, \txid, \_)$. Furthermore, 
whenever $\WTx(\ke, j) = \txid'$ for some $\txid'$ and $j > i$, then it must 
be the case that $\txid \xrightarrow{\VO_{\aexec}(\ke)} \txid'$, and because 
$\VO_{\aexec}(\ke)$ is transitive and irreflexive, it must be that  
$\neg( \txid' \xrightarrow{\VO_{\aexec}(\ke)} \txid)$ and $\txid \neq \txid'$: this implies that 
$\txid' \notin \T$. It follows that $\max(\getView(\aexec, \T)(\ke)) = i$, hence 
$\snapshot(\hh_{\aexec}, \getView(\aexec, \T)) = \valueOf(\hh_{\aexec}(\ke, i)) = \val$.
\end{enumerate}
\end{proof}

\begin{proposition}
\label{prop:compatible.kv2aexec}
Let $\vi \in \Views(\hh_{\aexec})$. Then there exists $\T \subseteq \T_{\aexec}$ 
such that $\getView(\aexec, \T) = \vi$, and $\RP_{\LWW}(\aexec, \T) = \snapshot(\hh_{\aexec}, \vi)$.
\end{proposition}

\begin{proof}
We only need to prove that, for any $\vi \in \Views(\hh_{\aexec})$, there exists $\T \subseteq \T_{\aexec}$ such 
that $\getView(\aexec, \T) = \vi$. Then it follows from \cref{prop:compatible.aexec2kv} that 
$\RP_{\LWW}(\aexec, \T) = \snapshot(\hh_{\aexec}, \vi)$. It suffices to choose $\T = \bigcup_{ke \in \Keys}(\{ \WTx(\hh_{\aexec}(\ke, i)) \mid i > 0 
\wedge i \in \vi(\ke)\})$.
Fix a key $\ke$, and let $i \in \vi(\ke)$. We prove that $i \in \getView(\aexec, \T)$. 
If $i = 0$, then $i \in \getView(\aexec, \T)$ by definition. 
Therefore, assume that $i > 0$. Let $\txid = \WTx(\hh_{\aexec}(\ke, i))$. It must be the case that $\txid \in \T$: by 
definition, $i \in \getView(\aexec, \T)(\ke)$.

Next, suppose that $i \in \getView(\aexec, \T)(\ke)$. We prove that $i \in \vi(\ke)$.
Note that if $i = 0$, then $i \in \vi(\ke)$ because of the 
definition of views. Let then $i > 0$. Because $i \in \getView(\aexec, \T)(\ke)$, we have that 
$\WTx(\hh_{\aexec}(\ke, i)) \in \T$.  Let $\txid := \WTx(\hh_{\aexec}(\ke, i))$. Because $i > 0$, 
it must be the case that $\txid \neq \txid_0$.
By definition, $\txid \in \T$ only if there 
exists an index $j$ and key $\ke'$, possibly different from $\ke$, such that $\WTx(\hh_{\aexec}(\ke', j)) = \txid$ and $j \in \vi(\ke')$. 
Because $\txid \neq \txid_0$ we have that $j > 0$. Finally, because $\vi$ is atomic by definition, $j \in \vi(\ke')$
$\WTx(\hh_{\aexec}(\ke', j)) = \txid = \WTx(\hh_{\aexec}(\ke, i))$, then it must be the case 
that $i \in \vi(\ke)$, which concludes the proof.
\end{proof}

\subsection{Proof of Theorem \ref{thm:kvtrace2aexec}}

\begin{lemma}
\label{lem:graph.extend}
Let $\aexec$ be an abstract execution, 
%$\cl$,  be a client such that $\txid \in \nextTxid(\cl, \T_{\aexec})$, 
$\txid \notin \T_{\aexec} \cup \{\txid_0\}$ be a transaction identifier $\T_{\aexec}$, and $\opset \in \Tx$. 
Let $\T \subseteq \T_{\aexec}$ be a set of transaction identifiers.
%\ac{$\nextTxId$ has been defined only for kv-stores, it must be defined for sets of transactions.}
Define $\Gr := \graphof(\aexec), \Gr' := \graphof(\extend(\aexec, \txid, \T, \opset))$. 
We have the following: 
\begin{enumerate}
\item for any $\txid' \in \T_{\Gr'}$, either $\txid' \in \T_{\Gr}$ and $\TtoOp{T}_{\Gr}(\txid') = \TtoOp{T}_{\Gr'}(\txid')$, 
or $\txid' = \txid$ and $\TtoOp{T}_{\Gr'}(\txid) = \opset$.
\item $\txid' \xrightarrow{\RF_{\Gr'}(\ke)} \txid''$ if and only if either 
$\txid' \xrightarrow{\RF_{\Gr}(\ke)_{\Gr}} \txid''$, or $(\otR, \ke, \_) \in \opset$, $\txid'' = \txid$ and 
$\txid' = \max_{\VO_{\Gr}(\ke)}(\T)$, 
\item $\txid' \xrightarrow{\VO_{\Gr'}(\ke)} \txid''$ if and only if 
either $\txid' \xrightarrow{\VO_{\Gr}(\ke)} \txid''$, or $(\otW, \ke, \_) \in \opset$, $\txid'' = \txid$, 
and $(\otW, \ke, \_) \in_{\Gr} \txid'$.
\end{enumerate}
\end{lemma}

\begin{proof}
Fix a key $\ke$. Let $\aexec' = \extend(\aexec, \txid, \T, \opset)$. Recall that $\Gr' = \graphof(\aexec')$.

\begin{enumerate}
\item By definition of $\extend$, and 
because $\txid \notin \T_{\aexec}$, we have that 
$\T_{\aexec'} = \T_{\aexec} \uplus \{\txid\}$. Furthermore, $\TtoOp{T}_{\aexec'}(\txid) = \opset$, 
from which it follows that $\TtoOp{T}_{\Gr'}(\txid) = \opset$.
For all $\txid' \in \T_{\aexec}$, we have that $\TtoOp{T}_{\aexec'}(\txid') = 
\TtoOp{T}_{\aexec}(\txid') = \TtoOp{T}_{\Gr}(\txid')$.
\item
Suppose that $\txid' \xrightarrow{\RF(\ke)_{\Gr}} \txid''$ for some $\txid', \txid'' \in \T_{\Gr}$. 
By definition, $(\otR, \ke, \_) \in_{\aexec} \txid''$,  
and $\txid' = \max_{\AR_{\aexec}}(\VIS_{\aexec}^{-1}(\txid'') \cap \{\txid''' \mid (\otW, \ke, \_) \in_{\aexec} \txid'''\})$. 
Because $\txid'' \in \T_{\Gr} = \T_{\aexec}$, it follows that $\txid'' \neq \txid$. By definition, 
$\VIS^{-1}_{\aexec'}(\txid'') = \VIS^{-1}_{\aexec}(\txid)$: also, whenever 
$\txid_{a}, \txid_{b} \in \VIS^{-1}_{\aexec'}(\txid)$ we have that $\txid_{a}, \txid_{b} \in \T_{\aexec}$, 
and therefore if $\txid_{a} \xrightarrow{\AR_{\aexec'}} \txid_{b}$, then it must be the case 
that $\txid_{a} \xrightarrow{\AR_{\aexec}} \txid_b$; also, $\TtoOp{T}_{\aexec}(\txid_{a}) = \TtoOp{T}_{\aexec'}(\txid_{a})$. 
As a consequence, we have that 
\[\max_{\AR_{\aexec'}}(\VIS^{-1}_{\aexec'}(\txid) \cap \{ \txid''' \mid (\otW, \ke, \_) \in_{\aexec'} \txid'''\}) = 
\max_{\AR_{\aexec}}(\VIS^{-1}_{\aexec}(\txid) \cap \{ \txid''' \mid (\otW, \ke, \_) \in_{\aexec} \txid'''\}) = \txid', \] 
and therefore $\txid' \xrightarrow{\RF_{\Gr'}} \txid$. 

Suppose now that $(\otR,\ke, \_) \in \opset$, and $\txid' = \max_{\VO(\ke)_{\Gr}}(\T)$. 
By Definition, $\txid' = \max_{\AR_{\aexec}}(\T) \cap \{ \txid''' \mid (\otW, \ke, \_) \in_{\aexec} \txid'''\}$, 
Also, $\T = \VIS^{-1}_{\aexec'}(\txid)$, and because $\T \subseteq \T_{\aexec}$, we have 
that for any $\txid_{a}, \txid_{b}$, if $\txid_{a} \xrightarrow{\AR_{\aexec}} \txid_{b}$, 
then $\txid_{a} \xrightarrow{\AR_{\aexec'}} \txid_{b}$; and $\TtoOp{T}_{\aexec'}(\txid_{a}) = 
TtoOp{T}_{\aexec}(\txid_a)$. Therefore, 
\[
\txid' = \max_{\AR_{\aexec'}}(\VIS^{-1}_{\aexec'}(\txid) \cap \{ \txid''' \mid (\otW, \ke, \_) \in_{\aexec'} \txid'''\}, 
\] 
from which it follows that $\txid' \xrightarrow{\RF_{\Gr'}(\ke)}\txid$.

Now, suppose that $\txid' \xrightarrow{\RF_{\Gr'}(\ke)} \txid''$ for some $\txid', \txid'' \in \T_{\Gr'} = 
\T_{\aexec'}$. We have that $ (\otR, \ke, \_) \in_{\aexec'} \txid''$, 
$(\otW, \ke, \_) \in_{\aexec'} \txid'$, and $\txid'' = \max_{\AR_{\aexec'}}(\VIS_{\aexec'}^{-1}(\txid'') 
\cap \{ \txid''' \mid (\otW, \ke, \_) \in_{\aexec'} \txid'''\}$. 
We also have that $\T_{\aexec'} = \T_{\aexec} \uplus \{\txid\}$. We perform a case 
analysis on $\txid''$. 

If $\txid'' = \txid$, then by definition of $\extend$ we have that 
$\VIS^{-1}_{\aexec'}(\txid) = \T$. Note that $\T \subseteq \T_{\aexec}$, so that 
for any $\txid_{a}, \txid_{b} \in \T_{\aexec}$, we have that $\txid_{a} \xrightarrow{\AR_{\aexec'}} \txid_{b}$ 
if and only if $\txid_{a} \xrightarrow{\AR_{\aexec}} \txid_{b}$, 
and $(\otW, \ke, \val) \in_{\aexec'} \txid_{a}$ if and only if $(\otW, \ke, \val) \in_{\aexec} \txid_{a}$. 
Thus, $\txid' = \max_{\AR_{\aexec}}(\T 
\cap \{\txid''' \mid (\otW, \ke, \_) \in_{\aexec} \txid'''\}) = \max_{\VO_{\Gr}(\ke)}(\T)$. 

If $\txid'' \in \T_{\aexec}$, then it is the case that 
$\txid' = \max_{\AR_{\aexec'}}(\VIS^{-1}_{\aexec'}(\txid'') \cap \{ \txid''' \mid (\otW, \ke, \_) \in_{\aexec'} \txid'''\}$. 
Similarly to the case above, we can prove that $\VIS^{-1}_{\aexec'}(\txid'') = \VIS^{-1}_{\aexec}(\txid)$, 
for any $\txid_{a}, \txid_{b} \in \VIS^{-1}_{\aexec}(\txid)$, $(\otW, \ke, \val) \in_{\aexec'} \txid_{a}$ 
implies $(\otW, \ke, \val) \in_{\aexec} \txid_{a}$, and $\txid_{a} \xrightarrow{\AR_{\aexec'}} \txid_{b}$ 
implies $\txid_{a} \xrightarrow{\AR_{\aexec}} \txid_{b}$, from which it follows that 
$\txid' = \max_{\AR_{\aexec}}(\VIS^{-1}_{\aexec}(\txid'') \cap \{ \txid''' \mid (\otW, \ke \_) \in_{\aexec} \txid'''\})$, 
and therefore $\txid' \xrightarrow{\RF_{\Gr}(\ke)} \txid''$.

\item Suppose that $\txid' \xrightarrow{\VO_{\Gr}(\ke)} \txid''$ for some $\txid', \txid'' \in \T_{\aexec}$. 
Then $(\otW,\ke,\_) \in_{\aexec} \txid', (\otW, \ke, \_) \in_{\aexec} \txid''$, and $\txid' \xrightarrow{\AR_{\aexec}} \txid''$. 
By definition of $\extend$, it follows that $\txid' \xrightarrow{\AR_{\aexec'}} \txid''$, and because 
$\txid', \txid'' \in \T_{\aexec}$, hence $\txid', \txid'' \neq \txid$, then 
$(\otW,\ke, \_) \in_{\aexec'} \txid'$, $(\otW, \ke, \_) \in_{\aexec'} \txid''$. By definition, 
we have that $\txid' \xrightarrow{\VO_{\aexec'}(\ke)} \txid''$.

Suppose that $(otW, \ke, \_) \in_{\aexec} \txid'$, $(\otW, \ke, \_) \in \opset$. Because $\txid' \in \T_{\aexec}$, 
we have that $\txid' \neq \txid$, hence $(\otW, \ke, \_) \in_{\aexec' }\txid'$. By definition, 
$\TtoOp{T}_{\aexec'}(\txid) = \opset$, hence $(\otW, \ke, \_) \in_{\aexec'} \txid$. Finally, 
the definition of $\extend$ ensures that $\txid' \xrightarrow{\AR_{\aexec'}} \txid$. Combining 
these three facts together, we obtain that  
$\txid' \xrightarrow{\VO_{\Gr'}(\ke)} \txid$. 

Now, suppose that $\txid' \xrightarrow{\VO_{\Gr'}(\ke)} \txid''$ for some $\txid', \txid'' \in \T_{\aexec}$. 
Then $\txid' \xrightarrow{\AR_{\aexec'}} \txid''$, $(\otW, \ke, \_) \in_{\aexec'} \txid'$, $(\otW, \ke, \_) 
\in_{\aexec'} \txid''$. 
Recall that $\T_{\Gr'} = \T_{\aexec'} = \T_{\aexec} \uplus \{ \txid \}$. We perform a case analysis on $\txid''$. 

If $\txid'' = \txid$, then the definition of $\extend$ ensures that $\txid' \xrightarrow{\AR_{\aexec'}} \txid$ 
implies that $\txid \in \T_{\aexec}$, hence $\txid' \neq \txid$. Together with $(\otW, \ke, \_) \in_{\aexec'} 
\txid'$, this leads to $(\otW, \ke, \_) \in_{\aexec} \txid'$. 

If $\txid'' \in \T_{\aexec}$, then $\txid'' \neq \txid$. The definition of $\extend$ ensures that $\txid' \xrightarrow{\AR_{\aexec}} \txid''$. 
This implies that $\txid', \txid'' \in \T_{\aexec}$, hence $\txid', \txid'' \neq \txid$, and $\TtoOp{T}_{\aexec'}(\txid') = \TtoOp{T}_{\aexec}(\txid')$, 
$\TtoOp{T}_{\aexec'}(\txid'') = \TtoOp{T}_{\aexec}(\txid'')$. It follows that $(\otW, \ke, \_) \in_{\aexec} \txid'$, 
$(\otW, \ke, \_) \in_{\aexec} \txid''$, and therefore $\txid' \xrightarrow{\VO_{\Gr}}(\ke) \txid''$.

\end{enumerate}
\end{proof}

\mypar{Proof of Proposition \ref{prop:kvtrace2aexec}}
Fix a $\ET_{\top}$-trace $\tau$. We prove \cref{prop:kvtrace2aexec} by induction 
on the number of transitions $n$ in $\tau$. 
\begin{itemize}
\item $n = 0$. Then $tau = (\hh_{0}, \_)$; it follows from \cref{def:kvtrace2aexec} that 
$\aexec_{\tau} = ([], \emptyset, emptyset)$. This triple satisfies the constraints 
of \cref{def:aexec}, as well as the resolution policy $\RP_{\LWW}$. 
It is also immediate to see that $\graphof(\aexec) = ([], \emptyset, \emptyset, \emptyset)$; in particular, 
$\T_{\graphof(\aexec)} = \emptyset$, and the only kv-store $\hh$ such that $\T_{\Gr_{\hh}} = \emptyset$ 
is given by $\hh = \hh_{0}$. By definition, $\hh_{\aexec_{\tau}} = \hh_{0}$, as we wanted to prove.

\item $n > 0$. In this case, we have that $\tau = \tau' \xrightarrowtriangle{(\cl, \mu)} (\hh, \viewFun)$ 
for some $\cl, \mu, \hh, \viewFun$. The $\ET_{\top}$-trace $\tau'$ contains exactly $n-1$ transititions, 
so that by induction we can assume that $\aexec_{\tau'}$ is a valid abstract execution that satisfies 
$\RP_{\LWW}$. Furthermore, $\lastConf(\tau') = (\hh_{\aexec_{\tau'}}, \viewFun')$ for some $\viewFun'$. 

We perform a case analysis on $\mu$. If $\mu = \varepsilon$, then it follows that $\hh = \hh_{\aexec_{\tau'}}$, 
and $\aexec_{\tau} = \aexec_{\tau'}$ by \cref{def:kvtrace2aexec}. By the inductive hypothesis 
$\aexec_{\tau}$ is an abstract execution that satisfies $\RP_{\LWW}$. Furthermore, 
$\lastConf(\tau) = (\hh, \_)$, and $\hh_{\aexec_{\tau}} = \hh_{\aexec_{\tau'}} = \hh$, 
and there is nothing left to prove. 

Suppose now that $\mu = \opset$, for some $\opset$. In this case we have that  
$\hh \in \updateKV(\hh_{\aexec_{\tau'}}, \viewFun'(\cl), \cl, \opset)$. Note that if 
$\opset = \emptyset$, then $\hh = \hh_{\aexec_{\tau'}}$ and $\aexec_{\tau} = \aexec_{\tau'}$. 
By the inductive hypothesis, $\aexec_{\tau}$ is an abstract execution that satisfies 
$\RP_{\LWW}$, and $\hh = \hh_{\aexec_{\tau'}} = \hh_{\aexec_{\tau}}$. 
Assume then that $\opset \neq \emptyset$. By definition, $\hh = \updateKV(\hh_{\aexec_{\tau'}}, 
\viewFun'(\cl), \txid, \opset)$ for some $\txid \in \nextTxId(\cl, \hh_{\aexec_{\tau}})$. It follows that $\txid$ 
is the unique transaction such that $\txid \notin \hh_{\aexec_{\tau'}}$, and $\txid \in \hh$ 
(the fact that $\txid \in \hh$ follows from the assumption that $\opset \neq \emptyset$). Let 
$\T = \Tx(\hh_{\aexec_{\tau'}}, \viewFun'(\cl))$; then $\aexec_{\tau} = \extend(\hh_{\aexec_{\tau'}}, \txid, \T, \opset)$. 
We first note that $\aexec_{\tau}$ satisfies the constraints of abstract execution required by \cref{def:kvtrace2aexec}.
\begin{itemize}
\item  Because $\txid \in \nextTxId(\cl, \hh_{\aexec_{\tau}})$, it must be the case that $\txid = \txid_{\cl}^{m}$ for some 
$m \geq 1$; we have that $\TtoOp{T}_{\aexec_{\tau}} = \TtoOp{T}_{\aexec_{\tau'}}\rmto{\txid_{\cl}^{m}}{\opset}$, 
from which it follows that 
\[
\T_{\aexec_{\tau}} = \dom(\TtoOp{T}_{\aexec_{\tau}}) = \dom(\TtoOp{T}_{\aexec_{\tau'}}) \cup 
\{\txid_{\cl}^{m} \} = \T_{\aexec_{\tau'}} \cup \{\txid_{\cl}^{m} \}.
\]
By inductive hypothesis, $\txid_0 \notin \T_{\aexec_{\tau'}}$, and therefore $\txid_{0} \notin 
\T_{\aexec_{\tau'}} \cup \{\txid_{\cl}^{m} \} = \T_{\aexec}$.
\item Let $(\txid' ,\txid'') \in \VIS_{\aexec_{\tau}}$. Then either $\txid'' = \txid_{\cl}^{m}$ and $\txid' \in \T$, or $(\txid', \txid'') \in 
\VIS_{\aexec_{\tau'}}$. In the former case, we have that $(\txid', \txid_{\cl}^{m}) \in \AR_{\aexec_{\tau}}$ by definition; 
in the latter case, we have that $(\txid', \txid'') \in \AR_{\aexec_{\tau'}}$ because $\aexec_{\tau'}$ is a valid 
abstract execution by inductive hypothesis, and therefore $(\txid', \txid'') \in \AR_{\aexec_{\tau}}$ by definition. 
This concludes the proof that $\VIS_{\aexec_{\tau}} \subseteq \AR_{\aexec_{\tau}}$. 
Also, observe that $\VIS_{\aexec_{\tau}}$ is irreflexive: if $(\txid', \txid'') \in \VIS_{\aexec_{\tau}}$, then either 
$(\txid' \txid'') \in \VIS_{\aexec_{\tau'}}$, and because $\VIS_{\aexec_{\tau'}}$ is irreflexive by the inductive hypothesis, 
then $\txid' \neq \txid''$; or $\txid'' = \txid_{\cl}^{m}$, $\txid' \in \T \subseteq \T_{\aexec_{\tau'}}$, 
and because $\txid_{\cl}^{m} \notin \hh_{\aexec_{\tau'}}$, then $\txid' \neq \txid_{\cl}^{m}$. 
\item Let $(\txid', \txid'') \in \T_{\aexec_{\tau}}$. We prove that $\AR_{\aexec_{\tau}}$ is total. 
Suppose that $\txid' \neq \txid''$.
\begin{enumerate}
\item If $\txid' \neq 
\txid_{\cl}^{m}$, $\txid'' \neq \txid_{\cl}^{m}$, then it must be the case that $\txid', \txid'' \in \T_{\aexec_{\tau'}}$; 
this is because we have already argued that $\T_{\aexec_{\tau}} = \T_{\aexec_{\tau'}} \cup \{\txid_{\cl}^{m}\}$. 
By the inductive hypothesis, we have that either $(\txid', \txid'') \in \AR_{\aexec_{\tau'}}$, or 
$(\txid'', \txid') \in \AR_{\aexec_{\tau'}}$. Because $\AR_{\aexec_{\tau'}} \subseteq \AR_{\aexec_{\tau}}$, 
then either $(\txid', \txid'') \in \AR_{\aexec_{\tau'}}$ or $(\txid'', \txid') \in \AR_{\aexec_{\tau}}$. 
\item if $\txid'' = \txid_{\cl}^{m}$, then it must be $\txid' \in \T_{\aexec_{\tau'}}$. By definition, 
$(\txid', \txid_{\cl}^{m}) \in \AR_{\aexec_{\tau}}$. Similarly, if $\txid' = \txid_{\cl}^{m}$, we 
can prove that $(\txid'', \txid_{\cl}^{m}) \in \AR_{\aexec_{\tau}}$.
\end{enumerate}
Next, we can employ the same proof used to show that $\VIS_{\aexec_{\tau}}$ is irreflexive 
to prove that $\AR_{\aexec_{\tau}}$ is irreflexive. Finally, let 
$(\txid', \txid'') \in \AR_{\aexec_{\tau}}$ and $(\txid'', \txid''') \in \AR_{\aexec_{\tau}}$. 
Note that it must be the case that $\txid', \txid'' \in \T_{\aexec_{\tau'}}$ by the definition of 
$\AR_{\aexec}$, and in particular $(\txid', \txid'') \in \AR_{\aexec_{\tau'}}$. 
For $\txid'''$, we have two possible cases. 
\begin{enumerate}
\item Either $\txid''' \in \T_{\aexec_{\tau}}$, from 
which it follows that $(\txid'', \txid''') \in \AR_{\aexec_{\tau'}}$; because
of $\AR_{\aexec_{\tau'}}$ is transitive by the inductive hypothesis, then 
$(\txid', \txid''') \in \AR_{\aexec_{\tau'}}$, and therefore $(\txid' ,\txid''') \in 
\AR_{\aexec_{\tau}}$.
\item Or $\txid''' = \txid_{\cl}^{m}$, and because $\txid' \in \T_{\aexec_{\tau'}}$, then 
$(\txid', \txid_{\cl}^{m}) \in \AR_{\aexec_{\tau}}$ by definition. 
\end{enumerate}
\item Let $\cl'$ be a client such that $(\txid_{\cl'}^{i}, \txid_{\cl'}^{j}) \in \AR_{\aexec_{\tau}}$. 
If $\cl' \neq \cl$, then it must be the case that $\txid_{\cl'}^{i}, \txid_{\cl'}^{j} \in \T_{\aexec_{\tau'}}$, 
and therefore $(\txid_{\cl'}^{i}, \txid_{\cl'}^{j}) \in \AR_{\aexec_{\tau'}}$. By the inductive hypothesis, 
it follows that $i < j$. If $\cl' = \cl$, then by definition of $\AR_{\aexec_{\tau}}$ it must be  $i \neq m$. 
If $j \neq m$ we can proceed as in the previous case to prove that $i < j$. If $j = m$, then 
note that $\txid_{\cl}^{i} \in \T_{\aexec_{\tau}}$ only if $\txid_{\cl}^{i} \in \hh_{\aexec_{tau'}}$. 
Because $\txid_{\cl}^{m} \in \nextTxId(\hh_{\aexec_{\tau'}}, \cl)$, then we have that $i < m$, 
as we wanted to prove.
\end{itemize}

Next, we prove that $\aexec_{\tau}$ satisfies the last write wins policy. 
Let $\txid' \in \T_{\aexec_{\tau}}$, and suppose that $(\otR, \ke, \val) \in_{\aexec_{\tau}} \txid'$. 
\begin{itemize} 
\item If $\txid' \neq \txid$, then we have that $\txid \in \T_{\aexec_{\tau'}}$. We also have that 
$\VIS^{-1}_{\aexec_{\tau}}(\txid') = \VIS^{-1}_{\aexec_{\tau'}}(\txid')$, $\AR^{-1}_{\aexec_{\tau}}(\txid') 
= \AR^{-1}_{\aexec_{\tau'}}(\txid')$; finally, for any $\txid'' \in \T_{\aexec_{\tau'}}$, 
$(\otW, \ke, \val') \in_{\aexec_{\tau}} \txid''$ if and only if $(\otW, \ke, \val') \in_{\aexec_{\tau'}} 
\txid''$. Therefore, let $\txid_{r} := \max_{\AR_{\aexec_{\tau}}}(\VIS^{-1}_{\aexec_{\tau}}(\txid') \cap 
\{\txid'' \mid (\otW, \ke, \_) \in_{\aexec_{\tau}} \txid''\})$. We have that $\txid_{r} = \max_{\AR_{\aexec_{\tau'}}}(\VIS^{-1}_{\aexec_{\tau'}}(\txid) 
\cap \{ \txid'' \mid (\otW, \ke, \_ \in_{\aexec_{\tau'}} \txid''\})$, and because $\aexec_{\tau'}$ satisfies the last write 
wins resolution policy,then $(\otW, \ke, \val) \in_{\aexec_{\tau'}} \txid_{r}$. This also implies that 
$(\otW, \ke, \va) \in_{\aexec_{\tau}} \txid_{r}$. 

\item Now, suppose that $\txid' = \txid$. Suppose that $(\otR, \ke \val) \in_{\aexec_{\tau}} \txid'$. 
By definition, we have that $(\otR, \ke, \val) \in \opset$. Recall that $\tau = \tau' \xrightarrow{(\cl, \opset)}_{\ET_{\top}} (\hh, \viewFun)$, 
and $\lastConf(\tau') = (\hh_{\aexec_{\tau'}}, \viewFun')$ for some $\viewFun'$. That is, we have that 
$(\hh_{\aexec_{\tau'}}, \viewFun') \xrightarrowtriangle{(\cl, \opset)}_{\ET_{\top}} (\hh, \viewFun)$, 
which in turn implies that $\ET_{\top} \vdash (\hh_{\aexec_{\tau'}}, \viewFun'(\cl)) \triangleright \opset : \viewFun(\cl)$. 
Let then $r : = \max\{i \mid  i \in \viewFun'(\cl)(\ke)\}$. 
By definition of execution test, and because $(\otR, \ke, \val) \in \opset$, then it must be the case that 
$\hh_{\aexec_{\tau'}}(\ke, r) = (\val, \txid'', \_)$ for some $\txid''$. 

We prove that 
$\txid'' = \max_{\AR_{\aexec_{\tau}}}(\VIS^{-1}_{\aexec_{\tau}}(\txid) \cap \{ \txid'' \mid (\otW, \ke, \_) \in_{\aexec_{\tau}} \txid''\})$. 
To this end, note that 
\[ 
\VIS^{-1}_{\aexec_{\tau}}(\txid) = \Tx(\hh_{\aexec_{\tau'}}, \viewFun'(\cl)) = \{\WTx(\hh_{\aexec_{\tau'}}(\ke',  i)) \mid \ke' \in \Keys \wedge  i \in \viewFun'(\cl)(\ke')\}.
\]
Note that $r \in \viewFun'(\cl)(\ke)$, and $\txid'' = \WTx(\hh_{\aexec_{\tau'}}(\ke, r))$. 
Therefore, $\txid'' \in \VIS^{-1}_{\aexec_{\tau}}(\txid)$. 
Because $\hh = \updateKV(\hh_{\aexec_{\tau'}}, \viewFun'(\cl), \txid, \opset)$, it 
must be the case that $\WTx(\hh(\ke, r)) = \txid''$. Also, because $\WTx(\hh_{\aexec_{\tau'}}(\ke, r) = \txid'') = \txid''$, 
then $(\otW, \ke, \_) \in_{\aexec_{\tau''}} \txid''$, or equivalently $(\otW, \ke, \_) \in \TtoOp{T}_{\aexec_{\tau'}}(\txid'')$. 
We have already proved that $\VIS_{\aexec_{\tau}}$ is irreflexive, hence it must be the case that $\txid'' \neq \txid$. 
In particular, because $\aexec_{\tau} = \extend(\aexec_{\tau'}, \txid, \_, \_)$, then we have that 
$\TtoOp{T}_{\aexec_{\tau}}(\txid'') = \TtoOp{T}_{\aexec_{\tau'}}\rmto{\txid}{\opset}(\txid'') = 
\TtoOp{T}_{\aexec_{\tau'}}(\txid'')$, hence $(\otW, \ke, \_) \in \TtoOp{T}_{\aexec_{\tau}}(\txid'')$. Equivalently, 
$(\otW, \ke, \_) \in_{\aexec_{\tau}} \txid''$. We have proved that $\txid'' \in \VIS^{-1}_{\aexec_{\tau}}(\txid)$, 
and $(\otW, \ke, \_) \in_{\aexec_{\tau}} \txid''$. 

Now let $\txid'''$ be such that $\txid''' \in \VIS^{-1}_{\aexec_{\tau}}(\txid)$, and $(\otW, \ke \_) \in_{\aexec_{\tau}} \txid'''$. 
Note that $\txid''' \neq \txid$ because $\VIS_{\aexec_{\tau}}$ is irreflexive.
We show that either $\txid''' = \txid''$, or $\txid''' \xrightarrow{\AR_{\aexec_{\tau}}} \txid''$. 
Because $\txid''' \in \VIS^{-1}_{\aexec_{\tau}}(\txid)$, then there exists a key $\ke'$ and an index $i \in \viewFun'(\cl)$ 
such that $\WTx(\hh_{\aexec_{\tau'}}(\ke', i)) = \txid'''$. Because $(\otW, \ke, \_) \in_{\aexec_{\tau}} \txid'''$, 
and because $\txid''' \neq \txid$, then $(\otW, \ke, \_) \in_{\aexec_{\tau'}} \txid'''$, and therefore there exists 
an index $j$ such that $\WTx(\hh_{\aexec_{\tau'}}(\ke, j)) = \txid'''$. We have that $\WTx(\hh_{\aexec_{\tau'}}(\ke, j) = 
\WTx(\hh_{\aexec_{\tau'}}(\ke', i))$, and $i \in \viewFun'(\cl)$. By \cref{eq:view.atomic}, it must be $j \in \viewFun'(\cl)$. 
Note that $r = \max\{i \mid i \in \viewFun'(\cl)\}$, hence we have that $j \leq r$. If $j = r$, then $\txid''' = \txid''$ and 
there is nothing left to prove. If $j < r$, then we have that $(\txid''', \txid'') \in \AR_{\aexec_{\tau'}}$, and 
therefore $(\txid''', \txid'') \in \AR_{\aexec_{\tau}}$.
\end{itemize}
Finally, we need to prove that $\hh = \hh_{\aexec_{\tau}}$.n
Recall that $\hh = \updateKV(\hh_{\aexec_{\tau'}}, \viewFun'(\cl), \txid, \opset)$, 
and $\aexec_{\tau} = \extend(\aexec_{\tau'}, \txid, \Tx(\hh_{\aexec_{\tau'}}, \viewFun'(\cl), \opset)$. 
We prove that, for any key $\ke$, $\lvert \hh(\ke) \rvert = \lvert \hh_{\aexec_{\tau}}(\ke) \rvert$, 
and for any $i=0,\cdots, \lvert \hh(\ke) \rvert - 1$, $\hh(\ke, i) = \hh_{\aexec_{\tau}}(\ke, i)$. 
\begin{itemize}
\item Note that, for any abstract execution $\aexec$ and key $\ke$, $\lvert \hh_{\aexec}(\ke) \rvert = 
\lvert \{ \txid' \mid (\otW, \ke, \_) \in_{\aexec} \txid' \} \rvert + 1$. 

Fix a key $\ke$. 
If $(\otW, \ke, \_) \notin \opset$, 
then $\{ \txid' \mid (\otW, \ke, \_) \in_{\aexec_{\tau}} \} = \{ \txid' \mid (\otW, \ke, \_) \in \aexec_{\tau'}\}$; 
we have that 
\[ 
\lvert \hh_{\aexec_{\tau}}(\ke) \rvert = \lvert \{ \txid' \mid (\otW, \ke, \_) \in_{\aexec_{\tau}} \txid' \} \rvert + 1 = 
\lvert \{ \txid' \mid (\otW, \ke, \_) \in_{\aexec_{\tau'}} \txid' \} \rvert + 1 = \lvert \hh_{\aexec_{\tau'}}(\ke) \rvert.
\]
Also, because $(\otW, \ke, \_) \notin \opset$, and because $\hh = \updateKV(\hh_{\aexec_{\tau'}}, \viewFun'(\cl), \txid, \opset)$, 
then $\lvert \hh(\ke) \rvert = \lvert \hh_{\aexec_{\tau'}}(\ke) \rvert$. Therefore we have that $\lvert \hh_{\aexec_{\tau}}(\ke) \rvert 
= \lvert \hh(\ke) \rvert$. 

If $(\otW, \ke, \_) \in \opset$, then $\{ \txid' \mid (\otW, \ke, \_) \in_{\aexec_{\tau}} \} = \{ \txid' \mid (\otW, \ke, \_) \in \aexec_{\tau'}\} 
\cup \{ \txid \}$, and therefore 
\[ 
\begin{array}{lllr}
\hh_{\aexec_{\tau}}(\ke) \rvert &=& \lvert \{ \txid' \mid (\otW, \ke, \_) \in_{\aexec_{\tau}} \txid' \} \rvert + 1 &= \\
&&\lvert \{ \txid' \mid (\otW, \ke, \_) \in_{\aexec_{\tau'}} \txid'\} \cup \{ \txid \} \rvert + 1 &= \\
&& \lvert \{ \txid' \mid(\otW, \ke, \_) \in_{\aexec_{\tau'}} \txid' \} \rvert + 1 + 1 &=\\
&& \lvert \hh_{\aexec_{\tau'}}(\ke) \rvert + 1 &.
\end{array}
\]
Also, because $(\otW, \ke, \_) \in \opset$, we have that 
\[ 
\lvert \hh(\ke) \rvert = \lvert \updateKV(\hh_{\aexec_{\tau'}}, \viewFun'(\cl), \txid, \opset)(\ke) \rvert = 
\lvert \hh_{\aexec_{\tau'}}(\ke) \rvert + 1,
\]
which concludes the proof that $\lvert \hh(\ke) \rvert = \lvert \hh_{\aexec_{\tau}}(\ke) \rvert$.
\item Fix a key $\ke$, and an index $i =0,\cdots, \lvert \hh(\ke) \rvert - 1$. We prove that 
$\hh(\ke, i) = \hh_{\aexec_{\tau}}(\ke, i)$. To this end, we consider several cases:
%Internal note: \hh = \updateKV(\hh_{\aexec_\tau'}, \viewFun'(\cl), \txid, \opset, 
%and \hh_{\aexec_{\tau}} = \extend(\hh_{\aexec_{\tau'}}, \txid, \Tx(\hh_{\aexec_{\tau'}}, \viewFun'(\cl)), \opset)

\end{itemize}

\end{itemize}