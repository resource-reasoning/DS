\subsection{Monotonic Read \( \MRd \)}
\label{sec:sound-complete-mr}

The execution test $\ET_\MRd$ is sound with respect to the axiomatic specification $(\RP_{\LWW}, \Set{\lambda \aexec. \VIS_{\aexec} ; \PO_{\aexec} })$. 
we choose an invariant as the following,  
\[
    I(\aexec, \cl) = \left( \bigcup_{\Setcon{\txid_{\cl}^{n} \in \T_{\aexec} }{ n \in \Nat}} \VIS_{\aexec}^{-1}(\txid^n_\cl) \right) \setminus \T_\rd
\]
where \( \T_\rd \) is all the read-only transactions in 
\( \bigcup_{\Setcon{\txid_{\cl}^{n} \in \T_{\aexec} }{ n \in \Nat}} \VIS_{\aexec}^{-1}(\txid^n_\cl) \).
Assume a kv-store $\hh$, an initial and a final view $\vi, \vi'$  a fingerprint $\opset$ 
such that $\ET_{\MRd} \vdash (\hh, \vi) \csat \opset: (\mkvs',\vi')$. 
Also choose an arbitrary $\cl$, a transaction identifier $\txid \in \nextTxId(\hh, \cl)$, 
and an abstract execution $\aexec$ such that $\hh_{\aexec} = \hh$ and 
\begin{equation}
I(\aexec, \cl) \subseteq \Tx(\hh, \vi)
\label{eq:mr_invariant}
\end{equation}
Let \( \aexec' = \extend(\aexec, \txid, \opset, \Tx(\hh, \vi) \cup \T_\rd) \).
We now check if \( \aexec' \) satisfies the axiomatic specification and the invariant is preserved:
\begin{itemize}
    \item $\Setcon{\txid' }{ (\txid', \txid) \in \VIS_{\aexec'} ; \PO_{\aexec'} } \subseteq \Tx(\hh, \vi) \cup \T_\rd$. 
Suppose that $\txid' \xrightarrow{\VIS_{\aexec'}} \txid'' \xrightarrow{\PO_{\aexec'}} \txid$ 
for some $\txid', \txid''$. We show that $\txid' \in I(\aexec, \cl)$, and then \cref{eq:mr_invariant} ensures 
that $\txid' \in \Tx(\hh, \vi) \cup \T_{\mathsf{rd}}$. 
Suppose $\txid'' \xrightarrow{\SO_{\aexec'}} \txid$, then $\txid'' = \txid_{\cl}^{n}$ for some $n \in \Nat$.
Because $\txid'' \neq \txid$ and $\T_{\aexec'} \setminus \T_{\aexec} = \Set{ \txid }$, we also 
have that $\txid'' \in \aexec$. By the invariant of $I(\aexec, \cl)$, 
we have that $\VIS^{-1}_{\aexec}(\cl) \subseteq I(\aexec, \cl)$:
because $\txid' \xrightarrow{\VIS_{\aexec'}} \txid''$ and $\txid'' \neq \txid$ we have 
that $\txid' \xrightarrow{\VIS_{\aexec}} \txid''$ and therefore $\txid' \in I(\aexec, \cl)$. 

\item $I(\aexec', \cl) \subseteq \Tx(\aexec', \vi') = \Tx(\hh', \vi')$. 
    In this case, because $\ET_{\MRd} \vdash (\hh, \vi) \csat \opset: (\mkvs',\vi')$, 
then it must be the case that $\vi \viewleq \vi'$. 
A trivial consequence of this fact is that $\Tx(\hh, \vi) \subseteq \Tx(\hh, \vi')$.
Also, because $\aexec' = \extend(\aexec, \txid, \Tx(\hh, \vi) \cup \T_{\mathsf{rd}})$, 
we have that $\Tx(\hh_{\aexec}, \vi) = \Tx(\hh_{\aexec'}, \vi)$. 
\ac{to infer this there should be a Lemma that states that if $\vi \in \Views(\hh)$, 
then $\Tx(\updateKV(\hh, \vi', \opset, \txid), \vi) = \Tx(\hh, \vi)$.}
Finally, note that $\Setcon{\txid_{\cl}^{n} \in \aexec' }{ n \in \Nat} = 
\Setcon{ \txid_{\cl}^{n} \in \T_{\aexec} }{ n \in \Nat} \cup \txid$, that for any 
$\txid_{\cl}^{n} \in \T_{\aexec}$ we have that $\VIS^{-1}_{\aexec'}(\txid_{\cl}^{n}) = 
\VIS^{-1}_{\aexec}(\txid_{\cl}^{n})$, and that 
$\VIS_{\aexec'}^{-1}(\txid) = \Tx(\hh, \vi) \cup \T_{\mathsf{rd}}$. 
Using all these facts, we obtain 
\[
\begin{rclarray}
    I(\aexec', \cl) &=& \left( \bigcup_{\Setcon{\txid_{\cl}^{n} \in \aexec' }{ n \in \Nat}} \VIS_{\aexec'}^{-1}(\txid_{\cl}^{n}) \right) \setminus \T_\rd \\
                &=& \left( \left( \bigcup_{\Setcon{\txid_{\cl}^{n} \in \aexec }{ n \in \Nat}} \VIS_{\aexec}^{-1}(\txid_{\cl}^{n}) \right) \setminus \T_\rd  \right) \cup \left( \VIS^{-1}_{\aexec'}(\txid) \setminus \T_\rd  \right) \\
&=& I(\aexec, \cl) \cup \Tx(\hh, \vi) \\
&\stackrel{\eqref{eq:mr_invariant}}{\subseteq}& \Tx(\hh, \vi) \\
&=& \Tx(\hh_\aexec, \vi) \\
&=& \Tx(\hh_{\aexec'}, \vi) \\
&\subseteq& \Tx(\hh_{\aexec'}, \vi')
\end{rclarray}
\]
\end{itemize}

We show that the execution test $\ET_{\MRd}$ is complete 
with respect to the axiomatic specification $(\RP_{\LWW}, \Set{\lambda \aexec.(\VIS_{\aexec};\PO_{\aexec})})$. 
Let $\aexec$ be an abstract execution that satisfies the specification
$\CMa(\RP_{\LWW}, \Set{\lambda \aexec.(\VIS_{\aexec};\PO_{\aexec})})$, 
and consider a transaction $\txid \in \T_{\aexec}$. 
Assume i-\emph{th} transaction \( \txid_i \) in the arbitrary order,
and let $\vi_i = \getView(\aexec, \VIS^{-1}_{\aexec}(\txid_{i}))$.
We have two possible cases: 
\begin{itemize}
    \item the transaction $\txid'_{i} = \min_{\PO_{\aexec}}\Setcon{\txid' }{ \txid_{i} \xrightarrow{\PO_{\aexec}} \txid'}$ is 
defined. In this case let $\vi'_{i} =\getView(\aexec, (\AR^{-1}_{\aexec})?(\txid_{i}) \cap \VIS^{-1}_{\aexec}(\txid'_{i}))$. 
Note that $\txid_{i} \xrightarrow{\PO_{\aexec}} \txid'_{i}$, and because $\aexec \models \VIS_{\aexec} ; \PO_{\aexec}$, 
it follows that $\VIS^{-1}_{\aexec}(\txid_{i}) \subseteq \VIS^{-1}_{\aexec}(\txid'_{i})$. 
We also have that $\VIS^{-1}_{\aexec}(\txid_{i}) \subseteq (\AR^{-1}_{\aexec})?(\txid_{i})$ because of 
the definition of abstract execution. It follows that 
\[
\VIS^{-1}_{\aexec}(\txid_{i}) \subseteq (\AR^{-1}_{\aexec})?(\txid_{i}) \cap \VIS^{-1}_{\aexec}(\txid'_{i}),
\]
Recall that  $\vi_i = \getView(\aexec, \VIS^{-1}_{\aexec}(\txid_{i}))$, 
and $\vi'_{i} =\getView(\aexec, (\AR^{-1}_{\aexec})?(\txid_{i}) \cap \VIS^{-1}_{\aexec}(\txid'_{i}))$. 
Thus we have that $\vi_i \viewleq \vi'_{i}$, and therefore $\ET_{\MRd} \vdash (\hh_{\cut(\aexec, i)}, \vi_i) 
\csat \TtoOp{T}_{\aexec}(\txid_{i}) : (\hh_{\cut(\aexec, i+1)},\vi'_{i})$. 
\item the transaction $\txid'_{i} = \min_{\PO_{\aexec}}\Setcon{\txid' }{ \txid_{i} \xrightarrow{\PO_{\aexec}} \txid_{i}}$ 
is not defined. In this case, let $\vi'_{i} = \getView(\aexec, (\AR^{-1}_{\aexec})?(\txid_{i}))$. 
As for the case above, we have that $\vi_i \viewleq \vi'_{i}$, and therefore 
$\ET_{\MRd} \vdash (\hh_{\cut(\aexec, i)}, \vi_i) \csat \TtoOp{T}_{\aexec}(\txid_{i}) : (\hh_{\cut(\aexec, i+1)},\vi'_{i}),\vi'_{i})$. 
\end{itemize}
