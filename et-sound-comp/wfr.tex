\subsection{Write Following Read \( \WFR \) }
\label{sec:sound-complete-wfr}

The write-read relation  on \( \aexec \) is defined as the following:
\[
\WR(\aexec, \ke) \defeq \Setcon{ (\txid, \txid') }{ \exsts{\val} (\otW, \ke, \val) \in_\aexec \txid \land (\otR, \ke, \val) \in_\aexec \txid' \land \txid = \max_\AR(\VIS^{-1}(\txid')) }
\]
The notation \( \WR_\aexec \) is defined as \( \WR_\aexec \defeq \bigcup_{\ke \in \Keys} \WR(\aexec, \ke) \).
Note that for a kv-store \( \mkvs \) such that \( \mkvs = \mkvs_\aexec \),
by the definition of  \(  \mkvs = \mkvs_\aexec \), 
the following holds:
\[
    \WR_\aexec = \Setcon{(\txid, \txid')}{\exsts{\ke, i } \mkvs(\ke, i) = (\stub, \txid, \txid'\cup \stub)}
\]
Note that such \( \WR_\aexec \) coincides with \( \WR_\Gr \) and \( \WR_\mkvs \).

The execution test $\ET_\WFR$ is sound with respect to the axiomatic specification 
\( (\RP_{\LWW}, \Set{\lambda \aexec. \WR_\aexec ; (\PO_{\aexec})? ; \VIS_{\aexec} })\).
We pick the invariant as \( I( \aexec, \cl ) = \emptyset \), given the fact of no constraint on the view after update.
Assume a kv-store $\hh$, an initial and a final view $\vi, \vi'$  a fingerprint $\opset$ 
such that $\ET_{\WFR} \vdash (\hh, \vi) \csat \opset: (\mkvs', \vi')$. 
Also choose an arbitrary $\cl$, a transaction identifier $\txid \in \nextTxId(\hh, \cl)$, 
and an abstract execution $\aexec$ such that $\hh_{\aexec} = \hh$ and 
\( I(\aexec, \cl) =  \emptyset \subseteq \Tx(\hh, \vi) \).
Let \( \aexec' = \extend(\aexec, \txid, \Tx(\mkvs, \vi) , \f ) \).
Note that since the invariant is empty set, it remains to prove the following (the read-only transactions set is empty):
\[
    \begin{array}{@{}l@{}}
        \fora{ \txid' } 
        (\txid' ,\txid)  \in \WR(\aexec',\ke) ; (\PO_{\aexec'})? ; \VIS_{\aexec'} 
        \implies \txid' \in \Tx(\mkvs, \vi) 
    \end{array}
\]
Suppose \( (\txid' ,\txid)  \in \WR(\aexec', \ke) ; (\PO_{\aexec'})? ; \VIS_{\aexec'} \) for some key \( \ke \),
that is, \( \txid' \toEdge{\WR(\aexec', \ke)} \txid'' \toEdge{\SO_{\aexec'}?} \txid''' \toEdge{\VIS_{\aexec'}} \txid \) for some transaction \( \txid''' \).
It immediately implies that \( \txid''' \in \Tx(\mkvs, \vi)  \) by \( \aexec' = \extend(\aexec, \txid, \Tx(\mkvs, \vi) , \f ) \).
Because \( \txid' \toEdge{\WR(\aexec', \ke)} \txid'' \), there exists an index \( i \) such that \( \mkvs(\ke, i) = (\stub, \txid', \txid'' \cup \stub) \).
By the execution test \( \ET_\WFR \), we have \( i \in \vi( \ke ) \) then \( \txid' \in \Tx(\mkvs, \vi ) \).


The execution test $\ET_\WFR$ is complete with respect to the axiomatic specification 
\( (\RP_{\LWW}, \Set{\lambda \aexec. \WR(\aexec', \ke) ; (\PO_{\aexec'})? ; \VIS_{\aexec'} })\).
Assume i-\emph{th} transaction \( \txid_i \) in the arbitrary order,
and let view \( \vi_{i} = \getView(\aexec, \VIS^{-1}_{\aexec}(\txid_{i}) ) \).
We also pick any final view such that \( \vi'_{i} \subseteq \getView(\aexec, (\AR^{-1}_{\aexec})?(\txid_{i}) ) \).
Note that there is nothing to prove for \( \vi'_i \),
so it is sufficient to prove the following:
\[
    \begin{array}{l}
    \fora{\ke, \ke', m, j, \txid'} j \in \vi(\ke)
    \land \txid' \in \RTx(\hh_{\cut(\aexec, i-1)}(\ke', m)) \land \txid' {\xrightarrow{\PO?}} \WTx(\hh_{\cut(\aexec, i-1)}(\ke, j)) ) 
    \implies m \in \vi(\ke')
    \end{array}
\]
Given a key \( \ke \) and an index \( j \) such that \( j \in \vi(\ke) \), 
it means that the writer \( \txid \) of the version \( \hh_{\cut(\aexec, i-1)}(\ke, j) \) is visible, \ie \( \txid \in \VIS_{\aexec'}^{-1}(\txid_i) \).
Assume some \( \txid' \) such that \( (\txid', \txid) \in (\PO_{\aexec'})? \) and reads a version of some key \( \mkvs(\ke',m) \).
Therefore, we know the writer of the key \( \txid'' = \WTx(\mkvs(\ke',i)) \) has a write-read edge to \( \txid' \), \ie \( \txid'' \toEdge{\WR_\aexec} \txid'\) 
By the constraint on abstract execution \( \aexec \), we know \( \txid'' \in \VIS^{-1}_{\aexec}(\txid_{i}) \),
which means \( m \in \vi(\ke')\) by the definition of \( \getView \).
