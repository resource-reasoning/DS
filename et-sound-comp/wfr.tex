\subsection{Write Following Read \( \WFR \) }
\label{sec:sound-complete-wfr}

The write-read relation  on \( \aexec \) is defined as the following:
\[
    \WR(\aexec, \key) \defeq \Set{ (\txid, \txid') }[ \exsts{\val} (\otW, \key, \val) \in_\aexec \txid \land (\otR, \key, \val) \in_\aexec \txid' \land \txid = \max_\AR(\VIS^{-1}(\txid')) ]
\]
The notation \( \WR_\aexec \) is defined as \( \WR_\aexec \defeq \bigcup_{\key \in \Keys} \WR(\aexec, \key) \).
Note that for a kv-store \( \mkvs \) such that \( \mkvs = \mkvs_\aexec \),
by the definition of  \(  \mkvs = \mkvs_\aexec \), 
the following holds:
\[
    \WR_\aexec = \Set{(\txid, \txid')}[\exsts{\key, i } \mkvs(\key, i) = (\stub, \txid, \txid'\cup \stub)]
\]
Note that such \( \WR_\aexec \) coincides with \( \WR_\Gr \) and \( \WR_\mkvs \).

The execution test $\ET_\WFR$ is sound with respect to the axiomatic definition 
\( (\RP_{\LWW}, \Set{\lambda \aexec. \WR_\aexec ; \SO_{\aexec}\rflx ; \VIS_{\aexec} })\).
We pick the invariant as \( I( \aexec, \cl ) = \emptyset \), given the fact of no constraint on the view after update.
Assume a kv-store $\mkvs$, an initial and a final view $\vi, \vi'$  a fingerprint $\fp$ 
such that $\ET_{\WFR} \vdash (\mkvs, \vi) \csat \fp: (\mkvs', \vi')$. 
Also choose an arbitrary $\cl$, a transaction identifier $\txid \in \nextTxid(\mkvs, \cl)$, 
and an abstract execution $\aexec$ such that $\mkvs_{\aexec} = \mkvs$ and 
\( I(\aexec, \cl) =  \emptyset \subseteq \Tx[\mkvs, \vi] \).
Let \( \aexec' = \extend[\aexec, \txid, \Tx[\mkvs, \vi], \fp] \).
Note that since the invariant is empty set, it remains to prove the following (the read-only transactions set is empty):
\[
    \begin{array}{@{}l@{}}
        \fora{ \txid' } 
        (\txid' ,\txid)  \in \WR(\aexec',\key) ; \SO_{\aexec'}\rflx ; \VIS_{\aexec'} 
        \implies \txid' \in \Tx[\mkvs, \vi]
    \end{array}
\]
Suppose \( (\txid' ,\txid)  \in \WR(\aexec', \key) ; \SO_{\aexec'}\rflx ; \VIS_{\aexec'} \) for some key \( \key \),
that is, \( \txid' \toEDGE{\WR(\aexec', \key)} \txid'' \toEDGE{\SO_{\aexec'}\rflx} \txid''' \toEDGE{\VIS_{\aexec'}} \txid \) for some transaction \( \txid''' \).
It immediately implies that \( \txid''' \in \Tx[\mkvs, \vi]  \) by \( \aexec' = \extend[\aexec, \txid, \Tx[\mkvs, \vi] , \fp] \).
Because \( \txid' \toEDGE{\WR(\aexec', \key)} \txid'' \), there exists an index \( i \) such that \( \mkvs(\key, i) = (\stub, \txid', \txid'' \cup \stub) \).
By the execution test \( \ET_\WFR \), we have \( i \in \vi( \key ) \) then \( \txid' \in \Tx[\mkvs, \vi] \).


The execution test $\ET_\WFR$ is complete with respect to the axiomatic definition 
\( (\RP_{\LWW}, \Set{\lambda \aexec. \WR(\aexec', \key) ; \SO_{\aexec'}\rflx ; \VIS_{\aexec'} })\).
Assume i-\emph{th} transaction \( \txid_i \) in the arbitrary order,
and let view \( \vi_{i} = \getView[\aexec, \VIS^{-1}_{\aexec}(\txid_{i})] \).
We also pick any final view such that \( \vi'_{i} \subseteq \getView[\aexec, (\AR^{-1}_{\aexec})\rflx(\txid_{i})] \).
Note that there is nothing to prove for \( \vi'_i \),
so it is sufficient to prove the following:
\[
    \begin{array}{l}
    \fora{\key, \key', m, j, \txid'} j \in \vi(\key)
    \land \txid' \in \rsOf(\mkvs_{\cut[\aexec, i-1]}(\key', m)) \land \txid' {\toEDGE{\SO\rflx}} \wtOf(\mkvs_{\cut[\aexec, i-1]}(\key, j)) ) 
    \implies m \in \vi(\key')
    \end{array}
\]
Given a key \( \key \) and an index \( j \) such that \( j \in \vi(\key) \), 
it means that the writer \( \txid \) of the version \( \mkvs_{\cut[\aexec, i-1]}(\key, j) \) is visible, \ie \( \txid \in \VIS_{\aexec'}^{-1}(\txid_i) \).
Assume some \( \txid' \) such that \( (\txid', \txid) \in \SO_{\aexec'}\rflx \) and reads a version of some key \( \mkvs(\key',m) \).
Therefore, we know the writer of the key \( \txid'' = \wtOf(\mkvs(\key',i)) \) has a write-read edge to \( \txid' \), \ie \( \txid'' \toEDGE{\WR_\aexec} \txid'\) 
By the constraint on abstract execution \( \aexec \), we know \( \txid'' \in \VIS^{-1}_{\aexec}(\txid_{i}) \),
which means \( m \in \vi(\key')\) by the definition of \( \getView \).
